(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7580190f"],{"06ea":function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"row-back"},[s("div",{staticClass:"row-back__container",on:{click:t.onClick}},[s("i",{staticClass:"row-back__icon el-icon-back"}),s("div",{staticClass:"row-back__text",domProps:{innerHTML:t._s(t.text)}})])])},a=[],n=s("9ab4"),r=s("60a3");let l=class extends r["e"]{onClick(){this.$emit("clicked")}};Object(n["a"])([Object(r["c"])()],l.prototype,"text",void 0),l=Object(n["a"])([Object(r["a"])({})],l);var o=l,c=o,d=(s("6de8"),s("0c7c")),u=Object(d["a"])(c,i,a,!1,null,"41db8cc2",null);e["a"]=u.exports},"0b4e":function(t,e,s){"use strict";s.r(e);var i=s("34dd"),a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"page-main page"},[s("div",{staticClass:"page-main__container"},[s("h1",{staticClass:"page-main__title page-title",domProps:{innerHTML:t._s(t.activeSection&&t.activeSection.title)}}),s("ListNews",{staticClass:"page-main__list",attrs:{list:t.currentList},on:{itemClicked:t.goToPageNews}}),s("PaginationApp",{staticClass:"page-main__pag",attrs:{total:t.listSorted&&t.listSorted.length,pageSize:t.pageSize,pagerCount:t.pagPagerCount},on:{currentChange:t.onCurrentChange,pageSizeChange:t.onPageSizeChange}})],1)])},n=[],r=s("9ab4"),l=s("60a3"),o=s("121b"),c=s("521f"),d=s("51a1"),u=s("8875"),h=s("f4e1"),b=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"list-news"},[s("div",{staticClass:"list-news__container"},[s("div",{staticClass:"list-news__table is-long-list"},[t.isLtMd?t._e():s("div",{staticClass:"list-news__row table-row table-head"},t._l(t.fields,(function(e,i){return s("div",{staticClass:"list-news__title table-cell",class:[{"is-sticky":e.isSticky&&t.isHorizontalOverscroll,"col-075":e.isSmall,"col-1":e.isMedium,"col-15":e.isXMedium,"col-2":e.isLarge,"col-3":e.isXLarge,"is-centered":e.isCentered}]},[s("TitleTable",{attrs:{title:e.title,isSortable:e.isSortable&&!!t.list&&!!t.list.length,isAscSorted:t.listSortField===t.fields[i].field&&t.isAscSorted,isDescSorted:t.listSortField===t.fields[i].field&&t.isDescSorted},on:{titleClicked:function(s){e.isSortable&&t.onTitleClick(i)}}})],1)})),0),t._l(t.list,(function(e,i){return s("ItemNews",{key:i,ref:"itemRef",refInFor:!0,staticClass:"list-news__item table-row",attrs:{titleIsShown:t.isLtMd,news:e,fields:t.fields},on:{clicked:function(s){return t.onItemClick(e)}}})}))],2)])])},p=[],g=s("2623"),f=s("13b5"),m=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"item-news"},[s("div",{staticClass:"item-news__info"},t._l(t.fields,(function(e,i){return s("div",{key:i,staticClass:"item-news__cell table-cell",class:[{"is-sticky":e.isSticky,"col-075":e.isSmall,"col-1":e.isMedium,"col-15":e.isXMedium,"col-2":e.isLarge,"col-3":e.isXLarge,"is-centered":e.isCentered}]},[t.titleIsShown&&e.title?s("div",{staticClass:"item-news__cell-title",domProps:{innerHTML:t._s(e.title+":&ensp;")}}):t._e(),e.field?s("div",{staticClass:"item-news__cell-text",domProps:{innerHTML:t._s(t.getFieldContent(e))}}):s("ButtonApp",{staticClass:"item-news__btn",attrs:{isLow:!0,isPlain:!0,fontSize:12,text:"Открыть"},on:{clicked:t.onBtnClick}})],1)})),0)])},_=[];let v=class extends l["e"]{onBtnClick(){this.$emit("clicked")}getFieldContent(t){const e=this.news[t.field],s="created_at"===t.field||"updated_at"===t.field,i="published"===t.field,a="pushed"===t.field;if(i){const t=e?"Да":"Нет",s=this.news["approved"]?"Да":"Нет";return t+"&nbsp;/&nbsp;"+s}if(a)return e?"Отправлен":"Не отправлен";if(s){const t=e.toString().match(/[^\s]+/)[0],s=Number(t.split("-")[2]);return s<2e3?"-":t}return e}};Object(r["a"])([Object(l["c"])()],v.prototype,"news",void 0),Object(r["a"])([Object(l["c"])()],v.prototype,"fields",void 0),Object(r["a"])([Object(l["c"])()],v.prototype,"titleIsShown",void 0),v=Object(r["a"])([Object(l["a"])({components:{ButtonApp:o["a"]}})],v);var w=v,C=w,x=(s("319a"),s("0c7c")),k=Object(x["a"])(C,m,_,!1,null,"c100949a",null),S=k.exports;const M=l["e"].extend({computed:{...g["b"].mapState(["breakpoint"])}}),L=l["e"].extend({computed:{...i["b"].mapState(["listSort"])},methods:{...i["b"].mapMutations(["updateListSort"])}});let F=class extends(Object(l["b"])(L,M,d["a"],u["a"])){get fields(){return[{field:"id",title:"ID",isSortable:!0,isSmall:this.isLg||this.isMd,isMedium:this.isXl,isCentered:!this.isLtMd},{field:"header",title:"Заголовок новости",isSortable:!0,isXLarge:!0},{field:"created_at",title:"Дата создания",isSortable:!0,isXMedium:!0,isCentered:!this.isLtMd},{field:"updated_at",title:"Дата обновления",isSortable:!0,isXMedium:!0,isCentered:!this.isLtMd},{field:"published",title:"Новость опубликована<br>веб&#8209;версия&nbsp;/&nbsp;приложение",isLarge:!0,isCentered:!this.isLtMd},{field:null,title:!this.isLtMd&&"Открыть",isMedium:!0,isCentered:!this.isLtMd}]}get isGtMd(){return"xl"===this.breakpoint||"lg"===this.breakpoint}get isLtMd(){return"xs"===this.breakpoint||"sm"===this.breakpoint}get isXl(){return"xl"===this.breakpoint}get isLg(){return"lg"===this.breakpoint}get isMd(){return"md"===this.breakpoint}get amountTotal(){return this.list&&this.list.length}get listSortField(){return this.listSort.by}get listSortDirection(){return this.listSort.direction}get isAscSorted(){return"asc"===this.listSortDirection}get isDescSorted(){return"desc"===this.listSortDirection}onTitleClick(t){const e=this.fields.map(t=>t.field)[t],s=e!==this.listSortField,i=s||"desc"===this.listSortDirection?"asc":"desc",a={by:e,direction:i};this.updateListSort(a)}resetSort(){const t={by:"updated_at",direction:"desc"};this.updateListSort(t)}onItemClick(t){this.$emit("itemClicked",t.id)}};Object(r["a"])([Object(l["c"])()],F.prototype,"list",void 0),F=Object(r["a"])([Object(l["a"])({components:{ItemNews:S,TitleTable:f["a"],ButtonApp:o["a"],MessageBox:c["a"]}})],F);var O=F,y=O,P=(s("f706"),Object(x["a"])(y,b,p,!1,null,"0099a97c",null)),T=P.exports,j=s("c34a");const B=l["e"].extend({computed:{...i["b"].mapGetters(["listSorted"])}}),N=l["e"].extend({computed:{...g["b"].mapState(["breakpoint"])}}),E=l["e"].extend({computed:{...h["b"].mapGetters(["activeMenuSectionByLink"])}});let I=class extends(Object(l["b"])(u["a"],d["a"],E,B,N)){constructor(){super(...arguments),this.pageSize=10,this.currentPage=1}get isXs(){return"xs"===this.breakpoint}get moduleLink(){return this.$route&&this.$route.matched&&this.$route.matched[0].path.slice(1)}get activeSection(){return this.moduleLink&&this.activeMenuSectionByLink(this.moduleLink)}get pagesAmount(){return this.listSorted&&this.listSorted.length/this.pageSize}get listByPages(){if(!this.listSorted)return;const t=[];for(let e=0;e<this.pagesAmount;e++){const s=e*this.pageSize,i=s+this.pageSize,a=this.listSorted.slice(s,i);t.push(a)}return t}get currentList(){return this.listByPages&&this.listByPages[this.currentPage-1]}get pagPagerCount(){return this.isXs?5:7}onCurrentChange(t){this.currentPage=t}onPageSizeChange(t){this.pageSize=t}goToPageNews(t){this.$router.push({path:`/${this.moduleLink}/item/${t}`}).catch(()=>{})}};I=Object(r["a"])([Object(l["a"])({components:{MessageBox:c["a"],ButtonApp:o["a"],ListNews:T,PaginationApp:j["a"]},mixins:[u["a"]]})],I);var $=I,D=$,H=(s("fe36"),Object(x["a"])(D,a,n,!1,null,"3421a5bf",null)),A=H.exports,z=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"page-item page"},[t.currentNews?s("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:t.onClickOutside,expression:"onClickOutside"}],staticClass:"page-item__container"},[s("RowBack",{staticClass:"page-item__row-back",attrs:{text:"Вернуться к списку"},on:{clicked:t.goToPageMain}}),s("CardNews",{staticClass:"page-item__card",attrs:{news:t.currentNews&&t.currentNews.data},on:{submitPublish:t.submitPublish,submitDelete:t.submitDelete}})],1):t._e(),s("transition",[s("MessageBox",{directives:[{name:"show",rawName:"v-show",value:t.msgBoxIsShown&&!t.fetchListFailed,expression:"msgBoxIsShown && !fetchListFailed"}],key:"msg",staticClass:"page-item__msg-box modal modal-msg",attrs:{content:t.msgBoxContent,secondBtn:t.secondBtn},on:{close:t.closeMsgBox,firstBtnClicked:t.onFirstBtnClick,secondBtnClicked:t.onSecondBtnClick}})],1)],1)},R=[],V=s("c28b"),X=s.n(V),q=s("06ea"),G=s("737a"),U=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"card-news"},[s("h1",{staticClass:"card-news__title page-title card-title"},[t._v("Информация о новости")]),t.news?s("div",{staticClass:"card-news__info-block"},[s("div",{staticClass:"card-news__info"},[s("div",{staticClass:"card-news__fields"},[s("div",{staticClass:"card-news__block card-news__block_dates"},[s("div",{staticClass:"card-news__fields card-news__fields_dates"},t._l(t.fieldsDates,(function(e,i){return s("div",{key:i,staticClass:"card-news__field card-news__field_dates card-field"},[s("div",{staticClass:"card-news__field-title card-field-title",domProps:{innerHTML:t._s(""+e.title)}}),s("div",{staticClass:"card-news__field-content card-field-content"},[s("div",{staticClass:"card-news__field-content-inner",domProps:{innerHTML:t._s(e.value)}})])])})),0)]),s("div",{staticClass:"card-news__block card-news__block_published"},[s("div",{staticClass:"card-news__field-title card-field-title"},[t._v("Новость опубликована")]),s("div",{staticClass:"card-news__fields card-news__fields_published"},t._l(t.fieldsPublished,(function(e,i){return s("div",{staticClass:"card-news__field card-news__field_published card-field"},[s("div",{staticClass:"card-news__icon-wrapper checkbox-icon-wrapper"},[s("i",{staticClass:"card-news__icon checkbox-icon",class:{"el-icon-check":e.value,"el-icon-close":!e.value}})]),s("div",{staticClass:"card-news__text field-content",domProps:{innerHTML:t._s(e.title)}})])})),0)]),s("BlockTexts",{staticClass:"card-news__block card-news__block_texts",attrs:{fields:t.fieldsTexts},on:{editModeIsOn:function(e){t.editMode=!0},editModeIsOff:function(e){t.editMode=!1}}})],1)]),s("div",{staticClass:"card-news__btns card-btns"},[s("ButtonApp",{directives:[{name:"show",rawName:"v-show",value:!t.editMode,expression:"!editMode"}],staticClass:"card-news__btn card-btn",attrs:{btnType:"primary",isPlain:!0,text:t.newsIsPublished?"Обновить новость":"Опубликовать новость"},on:{clicked:t.submitPublish}}),s("ButtonApp",{directives:[{name:"show",rawName:"v-show",value:t.newsIsPublished&&!t.editMode,expression:"newsIsPublished && !editMode"}],staticClass:"card-news__btn",attrs:{btnType:"danger",isPlain:!0,text:"Снять с публикации"},on:{clicked:t.submitDelete}})],1)]):t._e()])},J=[],Q=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"block-texts"},[s("div",{staticClass:"block-texts__container"},[s("div",{staticClass:"block-texts__tabs"},t._l(t.tabs,(function(e,i){return s("div",{key:i,staticClass:"block-texts__tab card-field-title",class:{"is-active":t.activeIndex===i,"is-disabled":t.editMode&&t.activeIndex!==i},domProps:{innerHTML:t._s(e)},on:{click:function(e){return t.setActiveIndex(i)}}})})),0),s("div",{staticClass:"block-texts__fields"},[0===t.activeIndex?s("div",{staticClass:"block-texts__edit-icons card-btn-close"},[t.editMode?t._e():s("div",{staticClass:"block-texts__edit-icon-wrapper",on:{click:t.turnOnEditMode}},[s("div",{staticClass:"block-texts__edit-icon el-icon-edit"}),s("div",{staticClass:"block-texts__icon-tooltip"},[t._v("Редактировать новость")])]),t.editMode?s("div",{staticClass:"block-texts__edit-icon-wrapper",on:{click:t.confirmEdit}},[s("div",{staticClass:"block-texts__edit-icon el-icon-check"}),s("div",{staticClass:"block-texts__icon-tooltip"},[t._v("Сохранить изменения")])]):t._e(),t.editMode?s("div",{staticClass:"block-texts__edit-icon-wrapper block-texts__edit-icon-wrapper_reset",on:{click:t.onResetClick}},[s("div",{staticClass:"block-texts__edit-icon el-icon-refresh"}),s("div",{staticClass:"block-texts__icon-tooltip"},[t._v("Отменить изменения")])]):t._e(),t.editMode?s("div",{staticClass:"block-texts__edit-icon-wrapper block-texts__edit-icon-wrapper_close",on:{click:t.onCloseClick}},[s("div",{staticClass:"block-texts__edit-icon el-icon-close"}),s("div",{staticClass:"block-texts__icon-tooltip"},[t._v("Отменить и закрыть")])]):t._e()]):t._e(),t._l(t.activeEditableFields,(function(e,i){return s("FieldText",{key:i,staticClass:"block-texts__field",attrs:{editMode:t.editMode,isEditorField:2===i,field:e},on:{inputChange:t.onInputChange}})}))],2),s("div",{directives:[{name:"show",rawName:"v-show",value:t.editMode,expression:"editMode"}],staticClass:"block-texts__btns card-btns"},[s("ButtonApp",{directives:[{name:"show",rawName:"v-show",value:t.editMode,expression:"editMode"}],staticClass:"block-texts__btn card-btn",attrs:{btnType:"primary",isPlain:!0,text:"Сохранить изменения"},on:{clicked:t.confirmEdit}}),s("ButtonApp",{staticClass:"block-texts__btn card-btn",attrs:{btnType:"warning",isPlain:!0,text:"Сбросить изменения"},on:{clicked:t.onResetClick}}),s("ButtonApp",{staticClass:"block-texts__btn card-btn",attrs:{btnType:"danger",isPlain:!0,text:"Отменить редактирование"},on:{clicked:t.onCloseClick}})],1)])])},K=[],W=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"field-text"},[s("div",{staticClass:"field-text__container"},[s("div",{staticClass:"field-text__title card-field-title",domProps:{innerHTML:t._s(t.field.title)}}),s("div",{staticClass:"field-text__content card-field-content",style:t.setContentStyle(),attrs:{tag:"div"}},[s("transition",[t.editMode||!t.inputHeight&&!t.isEditorField?!t.editMode&&t.inputHeight||t.isEditorField?t._e():s("el-input",{key:"input",ref:"inputRef",staticClass:"field-text__content-inner field-text__content-inner_input",attrs:{clearable:"",placeholder:t.field.title},on:{input:t.emitInputChange},model:{value:t.editableText,callback:function(e){t.editableText=e},expression:"editableText"}}):s("div",{key:"main",staticClass:"field-text__content-inner field-text__content-inner_main",domProps:{innerHTML:t._s(t.editableText)}})],1),t.isEditorField?s("div",{key:"editable",staticClass:"field-text__content-inner field-text__content-inner_editable",class:{"is-transparent":!t.editMode},attrs:{id:"editor-field"},domProps:{innerHTML:t._s(t.editorHtmlTextInitial)}}):t._e()],1)])])},Y=[],Z=s("b1fc"),tt=s.n(Z);const et=l["e"].extend({}),st=l["e"].extend({computed:{...g["b"].mapState(["breakpoint"])}});let it=class extends(Object(l["b"])(st,et)){constructor(){super(...arguments),this.froala=null,this.editableText=null,this.editorHtmlTextInitial=null,this.inputHeight=null}get isLtMd(){return"xs"===this.breakpoint||"sm"===this.breakpoint}get fieldTitle(){return this.field.title}get fieldValue(){return this.field.value}get configToolbarButtons(){return this.isLtMd?{moreText:{buttons:["bold","italic","underline","strikeThrough","subscript","superscript","clearFormatting"],buttonsVisible:0},moreParagraph:{buttons:["alignLeft","alignCenter","alignRight","alignJustify","formatOL","formatUL","paragraphFormat","lineHeight","outdent","indent"],buttonsVisible:0},moreRich:{buttons:["insertLink","insertImage","specialCharacters","insertHR"],buttonsVisible:0},moreMisc:{buttons:["undo","redo","selectAll","print","fullscreen"],align:"right",buttonsVisible:0}}:{moreText:{buttons:["bold","italic","underline","strikeThrough","subscript","superscript","clearFormatting"]},moreParagraph:{buttons:["alignLeft","alignCenter","alignRight","alignJustify","formatOL","formatUL","paragraphFormat","lineHeight","outdent","indent"]},moreRich:{buttons:["insertLink","insertImage","specialCharacters","insertHR"]},moreMisc:{buttons:["undo","redo","selectAll","print","fullscreen"],align:"right"}}}get configQuickInsertOptions(){return this.isLtMd?null:["image","embedly","table","ul","ol","hr"]}get config(){return{charCounterCount:!1,language:"ru",quickInsertButtons:this.configQuickInsertOptions,keepFormatOnDelete:!0,linkEditButtons:["linkOpen","linkEdit","linkRemove"],toolbarButtons:this.configToolbarButtons,events:{contentChanged:()=>{this.onEditorInputChange()}}}}async onFieldChange(t){t!==this.editableText&&(this.inputHeight=null,this.isEditorField?(this.editableText=t,this.froala.html.set(t)):(this.editableText=t,await this.$nextTick(),this.getInputHeight()))}async onEditModeChange(t){t&&this.isEditorField&&!this.froala&&(await this.$nextTick(),this.initEditor()),!t&&this.isEditorField&&(this.froala.html.get()!==this.field.value?(this.editableText=this.field.value.toString(),this.froala.html.set(this.field.value),await this.$nextTick()):this.editableText!==this.fieldValue&&(this.editableText=this.field.value,await this.$nextTick()))}async mounted(){this.editableText=this.field.value.toString(),this.editorHtmlTextInitial=this.field.value.toString(),await this.$nextTick(),this.isEditorField?this.initEditor():this.getInputHeight()}async getInputHeight(){const t=this.inputRef;t&&(this.inputHeight=t.$el?t.$el.firstElementChild.offsetHeight:t.offsetHeight)}initEditor(){this.froala=new tt.a("#editor-field",this.config)}destroyEditor(){this.froala&&(this.froala.destroy(),this.froala=null)}setContentStyle(){if(this.inputHeight)return`height: ${this.inputHeight}px;`}async onEditorInputChange(){await this.$nextTick();const t=this.froala.html.get();this.editableText=t,this.emitInputChange()}emitInputChange(){const t=this.editableText;this.$emit("inputChange",t,this.field.field)}};Object(r["a"])([Object(l["c"])()],it.prototype,"field",void 0),Object(r["a"])([Object(l["c"])()],it.prototype,"editMode",void 0),Object(r["a"])([Object(l["c"])()],it.prototype,"isEditorField",void 0),Object(r["a"])([Object(l["d"])()],it.prototype,"inputRef",void 0),Object(r["a"])([Object(l["f"])("fieldValue")],it.prototype,"onFieldChange",null),Object(r["a"])([Object(l["f"])("editMode")],it.prototype,"onEditModeChange",null),it=Object(r["a"])([Object(l["a"])({})],it);var at=it,nt=at,rt=(s("d25c"),s("17c9"),Object(x["a"])(nt,W,Y,!1,null,"32a6fe6c",null)),lt=rt.exports;const ot=l["e"].extend({computed:{...i["b"].mapState(["textsForPublish","textsForEdit"])},methods:{...i["b"].mapMutations(["setTextsForPublish","updateTextForPublish","setTextsForEdit","resetTextsForEdit","updateTextForEdit"])}});let ct=class extends(Object(l["b"])(ot)){constructor(){super(...arguments),this.tabs=["Мобильное приложение","Веб-версия"],this.activeIndex=0,this.editableIndex=0,this.editMode=!1,this.editableFields=null}get activeFields(){return this.fields[this.activeIndex]}get activeIsEditable(){return this.activeIndex===this.editableIndex}get activeEditableFields(){return this.editableFields&&this.editableFields[this.activeIndex]}get initialFieldsPublished(){return this.fields[this.editableIndex]}get editableFieldsPublished(){return this.editableFields[this.editableIndex]}mounted(){this.editableFields=[...this.fields.map(t=>t.map(t=>({...t})))],this.setTextsForPublish([...this.editableFieldsPublished.map(t=>({...t}))]),this.setTextsForEdit([...this.editableFieldsPublished.map(t=>({...t}))])}setActiveIndex(t){this.activeIndex=t}turnOnEditMode(){this.editMode=!0,this.$emit("editModeIsOn")}turnOffEditMode(){this.editMode=!1,this.$emit("editModeIsOff")}confirmEdit(){this.turnOffEditMode(),this.setTextsForPublish([...this.textsForEdit.map(t=>({...t}))])}resetForPublish(){this.editableFields=[...this.fields.map(t=>t.map(t=>({...t})))],this.setTextsForPublish([...this.initialFieldsPublished.map(t=>({...t}))])}resetForEdit(){this.editableFields=[...this.fields.map(t=>t.map(t=>({...t})))],this.resetTextsForEdit()}onResetClick(){this.resetForEdit()}async onCloseClick(){this.resetForEdit(),await this.$nextTick(),this.turnOffEditMode()}onInputChange(t,e){const s=this.editableFields[this.activeIndex],i=s.find(t=>t.field===e);i.value=t,this.updateTextForEdit({field:e,value:t})}};Object(r["a"])([Object(l["c"])()],ct.prototype,"fields",void 0),ct=Object(r["a"])([Object(l["a"])({components:{FieldText:lt,ButtonApp:o["a"]}})],ct);var dt=ct,ut=dt,ht=(s("cee6"),Object(x["a"])(ut,Q,K,!1,null,"5f876759",null)),bt=ht.exports;const pt=l["e"].extend({computed:{},methods:{...i["b"].mapMutations(["setTextsForPublish","resetTextsForEdit"])}});let gt=class extends(Object(l["b"])(pt)){constructor(){super(...arguments),this.editMode=!1}get newsIsPublished(){return this.news.approved}get fieldId(){return{field:"id",title:"ID",value:this.getFieldContent("id")}}get fieldsDates(){return[this.fieldId,{field:"created_at",title:"Дата создания",value:this.getFieldContent("created_at")},{field:"updated_at",title:"Дата обновления",value:this.getFieldContent("updated_at")}]}get fieldsPublished(){return[{field:"approved",title:"в приложении",value:this.getFieldContent("approved")},{field:"published",title:"в  веб-версии",value:this.getFieldContent("published")}]}get fieldsTexts(){return[[{field:"headerMobile",title:"Заголовок",value:this.getFieldContent("headerMobile")},{field:"previewMobile",title:"Превью",value:this.getFieldContent("previewMobile")},{field:"bodyMobile",title:"Текст",value:this.getFieldContent("bodyMobile")}],[{field:"header",title:"Заголовок",value:this.getFieldContent("header")},{field:"preview",title:"Превью",value:this.getFieldContent("preview")},{field:"body",title:"Текст",value:this.getFieldContent("body")}]]}getFieldContent(t){if(!this.news)return;const e=this.news[t],s="created_at"===t||"updated_at"===t,i="headerMobile"===t,a="previewMobile"===t,n="bodyMobile"===t;if(s){const t=e.toString().match(/[^\s]+/)[0],s=Number(t.split("-")[2]);return s<2e3?"-":t}return i&&!e?this.news["header"]:a&&!e?this.news["preview"]:n&&!e?this.news["body"]:e}submitPublish(){this.$emit("submitPublish")}submitDelete(){this.$emit("submitDelete")}resetChanges(){this.resetTextsForEdit()}};Object(r["a"])([Object(l["c"])()],gt.prototype,"news",void 0),gt=Object(r["a"])([Object(l["a"])({directives:{clickOutside:X.a.directive},components:{ButtonApp:o["a"],BlockTexts:bt}})],gt);var ft=gt,mt=ft,_t=(s("7d55"),Object(x["a"])(mt,U,J,!1,null,"40938ea4",null)),vt=_t.exports;const wt=l["e"].extend({computed:{...i["b"].mapState(["currentNews"]),...i["b"].mapGetters(["newsById"])},methods:{...i["b"].mapMutations(["clearCurrentNews"]),...i["b"].mapActions(["getCurrentNews","publishNews","deleteNews"])}});let Ct=class extends(Object(l["b"])(u["a"],d["a"],wt)){constructor(){super(...arguments),this.secondBtn=null}get fetchListFailed(){return"failFetchList"===this.requestStatus}get currentId(){return this.$route.params.id}created(){this.getData(!1),document.addEventListener("keydown",this.keydownHandler)}async mounted(){await this.$nextTick(),Object(G["a"])()}beforeDestroy(){document.removeEventListener("keydown",this.keydownHandler),this.clearCurrentNews()}goToPageMain(){this.$router.push({name:"PageNews"}).catch(t=>{})}getData(t){this.getCurrentNews({id:Number(this.currentId),forceUpdate:t}).catch(()=>{this.requestStatus="failFetchCurrentNews",this.secondBtn={type:"success",isPlain:!0},this.openMsgBox()})}submitPublish(){this.publishNews(Number(this.currentId)).then(()=>{this.getData(!0)}).catch(()=>{this.requestStatus="failPublish",this.secondBtn={type:"danger",isPlain:!0},this.openMsgBox()})}submitDelete(){this.deleteNews(Number(this.currentId)).then(()=>{this.getData(!0)}).catch(()=>{this.requestStatus="failPublish",this.secondBtn={type:"danger",isPlain:!0},this.openMsgBox()})}onFirstBtnClick(){switch(this.closeMsgBox(),this.requestStatus){case"failFetchCurrentNews":this.getData(!1);break;case"failPublish":this.submitPublish();break;case"failDelete":this.submitDelete();break}}onSecondBtnClick(){switch(this.closeMsgBox(),this.requestStatus){case"failFetchCurrentNews":this.goToPageMain();break;case"failPublish":case"failDelete":break}}keydownHandler(t){"Escape"===t.key&&this.msgBoxIsShown&&this.closeMsgBox()}onClickOutside(t){const e=t.srcElement.classList.contains("page-item");e&&this.goToPageMain()}};Ct=Object(r["a"])([Object(l["a"])({directives:{clickOutside:X.a.directive},components:{CardNews:vt,MessageBox:c["a"],RowBack:q["a"],ButtonApp:o["a"]}})],Ct);var xt=Ct,kt=xt,St=(s("6844"),Object(x["a"])(kt,z,R,!1,null,"19e39159",null)),Mt=St.exports;const Lt=[{path:"list",component:A,name:"PageNews"},{path:"news",redirect:{name:"PageNews"}},{path:"item/:id",component:Mt,name:"PageNewsItem"},{path:"*",redirect:{name:"PageNews"}}];var Ft=[{path:"/news",component:()=>s.e("news").then(s.bind(null,"0d7a")),name:"ModuleNews",redirect:{name:"PageNews"},children:Lt,meta:{title:"Баннеры",isDynamicModule:!0}}];e["default"]={name:"news",store:i["a"],routes:Ft}},"118c":function(t,e,s){},"13b5":function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"title-table"},[s("div",{staticClass:"title-table__wrapper",class:{"is-disabled":!t.isSortable},on:{click:t.onTitleClick}},[s("div",{staticClass:"title-table__text",domProps:{innerHTML:t._s(t.title)}}),t.isSortable?s("div",{staticClass:"title-table__sort"},[s("i",{staticClass:"title-table__sort-icon el-icon-caret-top",class:{"is-active":t.isAscSorted}}),s("i",{staticClass:"title-table__sort-icon el-icon-caret-bottom",class:{"is-active":t.isDescSorted}})]):t._e()])])},a=[],n=s("9ab4"),r=s("60a3");let l=class extends r["e"]{onTitleClick(){this.$emit("titleClicked")}};Object(n["a"])([Object(r["c"])()],l.prototype,"title",void 0),Object(n["a"])([Object(r["c"])()],l.prototype,"isSortable",void 0),Object(n["a"])([Object(r["c"])()],l.prototype,"isAscSorted",void 0),Object(n["a"])([Object(r["c"])()],l.prototype,"isDescSorted",void 0),l=Object(n["a"])([Object(r["a"])({})],l);var o=l,c=o,d=(s("e8b9"),s("0c7c")),u=Object(d["a"])(c,i,a,!1,null,"360beddc",null);e["a"]=u.exports},"17c9":function(t,e,s){"use strict";var i=s("2e8e"),a=s.n(i);a.a},"1a9b":function(t,e,s){},"2e69":function(t,e,s){},"2e8e":function(t,e,s){},"319a":function(t,e,s){"use strict";var i=s("6484"),a=s.n(i);a.a},"34dd":function(t,e,s){"use strict";(function(t){s.d(e,"a",(function(){return h})),s.d(e,"b",(function(){return b}));var i=s("e738"),a=s("675f");const n=!0,r=t&&Object({NODE_ENV:"production",BASE_URL:"/"})&&!1;class l{constructor(){this.currentNews={data:null,isLoading:null,error:null},this.list={data:null,isLoading:null,error:null},this.listSort={by:"created_at",direction:"desc"},this.textsForEdit=null,this.textsForPublish=null,this.publish={isLoading:!1,error:null},this.delete={isLoading:!1,error:null}}}class o extends a["b"]{get isLoading(){return this.state.list.isLoading||this.state.currentNews.isLoading||this.state.publish.isLoading||this.state.delete.isLoading}get loadingError(){return this.state.list.error||this.state.currentNews.error||this.state.publish.error||this.state.delete.error}get listSorted(){if(!this.state.list.data||!this.state.list.data.length)return;const t=[...this.state.list.data],e=this.state.listSort.by,s=this.state.listSort.direction;return t.sort((t,i)=>{let a=t[e],n=i[e];switch(e){case"header":case"headerMobile":a=a.toString().trim().toLowerCase(),n=n.toString().trim().toLowerCase();break;case"id":a=Number(a),n=Number(n);break;case"created_at":case"updated_at":a=u(a),n=u(n);break}return a>n&&"asc"===s||a<n&&"desc"===s?1:-1})}get newsById(){return t=>this.state.list.data.find(e=>e.id===t)}get publishPayload(){const t=this.state.textsForPublish,e=t.find(t=>"headerMobile"===t.field).value,s=t.find(t=>"previewMobile"===t.field).value,i=t.find(t=>"bodyMobile"===t.field).value,a=Object.assign({});return a.approve=!0,e&&(a.header=e),s&&(a.preview=s),i&&(a.body=i),a}}class c extends a["d"]{updateListSort(t){this.state.listSort.by=t.by,this.state.listSort.direction=t.direction}startListLoading(){this.state.list.isLoading=!0,this.state.list.error=null}setListLoadingSuccess(t){this.state.list.data=t,this.state.list.error=null,this.state.list.isLoading=!1}setListLoadingFail(t){this.state.list.data=null,this.state.list.error=t,this.state.list.isLoading=!1}startCurrentNewsLoading(){this.state.currentNews.isLoading=!0,this.state.currentNews.error=null}setCurrentNewsLoadingSuccess(t){this.state.currentNews.data=t,this.state.currentNews.isLoading=!1,this.state.currentNews.error=null}setCurrentNewsLoadingFail(t){this.state.currentNews.data=null,this.state.currentNews.isLoading=!1,this.state.currentNews.error=t}clearCurrentNews(){this.state.currentNews.data=null,this.state.currentNews.isLoading=!1,this.state.currentNews.error=null}setTextsForPublish(t){this.state.textsForPublish=t}updateTextForPublish(t){const e=this.state.textsForPublish,s=e.find(e=>e.field===t.field);s.value=t.value}setTextsForEdit(t){this.state.textsForEdit=t}updateTextForEdit(t){const e=this.state.textsForEdit,s=e.find(e=>e.field===t.field);s.value=t.value}resetTextsForEdit(){this.state.textsForEdit=this.state.textsForPublish}startPublish(){this.state.publish.isLoading=!0,this.state.publish.error=null}setPublishSuccess(){this.state.publish.isLoading=!1,this.state.publish.error=null}setPublishFail(t){this.state.publish.isLoading=!1,this.state.publish.error=t}startDelete(){this.state.publish.isLoading=!0,this.state.publish.error=null}setDeleteSuccess(){this.state.publish.isLoading=!1,this.state.publish.error=null}setDeleteFail(t){this.state.publish.isLoading=!1,this.state.publish.error=t}}class d extends a["a"]{async getList(t){return new Promise(async(e,s)=>{this.commit("startListLoading",null),t&&await i["a"].get("/api/v1/news-migrate"),i["a"].get("/api/v1/news-list").then(t=>{while(!Array.isArray(t))t=t.data;this.commit("setListLoadingSuccess",t),r&&console.log("Success: load news list"),e()}).catch(t=>{const e=t&&t.response&&t.response.data&&t.response.data.message||null;this.commit("setListLoadingFail",e),t&&t.response?s(t.response):s()})})}async getCurrentNews(t){return new Promise(async(e,s)=>{this.commit("startCurrentNewsLoading"),t.forceUpdate&&await i["a"].get("/api/v1/news-migrate"),i["a"].get(`/api/v1/news-detail/${t.id}`).then(s=>{const i=s.data;this.commit("setCurrentNewsLoadingSuccess",i),r&&console.log("Success: load current news, id: "+t.id),e()}).catch(t=>{r&&t&&t.response?console.log(t.response):console.log("error");const e=t&&t.response&&t.response.data&&t.response.data.message||null;this.commit("setCurrentNewsLoadingFail",e),t&&t.response?s(t.response):s()})})}async publishNews(t){return new Promise(async(e,s)=>{this.commit("startPublish");const a=this.getters.publishPayload;i["a"].post(`/api/v1/news-update/${t}`,a).then(s=>{const i=s.data;this.commit("setPublishSuccess",i),r&&console.log("Success: publish news, id: "+t),e()}).catch(t=>{r&&t&&t.response?console.log(t.response):console.log("error");const e=t&&t.response&&t.response.data&&t.response.data.message||null;this.commit("setPublishFail",e),t&&t.response?s(t.response):s()})})}async deleteNews(t){return new Promise(async(e,s)=>{this.commit("startDelete"),i["a"].delete(`/api/v1/news-delete/${t}`).then(s=>{const i=s.data;this.commit("setDeleteSuccess",i),r&&console.log("Success: delete news, id: "+t),e()}).catch(t=>{r&&t&&t.response?console.log(t.response):console.log("error");const e=t&&t.response&&t.response.data&&t.response.data.message||null;this.commit("setDeleteFail",e),t&&t.response?s(t.response):s()})})}}const u=t=>{const e=/(\d{2})\-(\d{2})\-(\d{4}) (\d{2}):(\d{2})/,s=t.match(e),i=Number(s[3]),a=Number(s[2])-1,n=Number(s[1]),r=Number(s[4]),l=Number(s[5]),o=new Date(i,a,n,r,l);return Date.parse(o.toString())},h=new a["c"]({namespaced:n,state:l,getters:o,mutations:c,actions:d}),b=Object(a["e"])(h)}).call(this,s("4362"))},"5c0d":function(t,e,s){"use strict";s.d(e,"a",(function(){return i}));class i{constructor(t){this.options=t;let e=t.targets;(e instanceof NodeList||e instanceof HTMLCollection)&&(e=Array.from(e)),Array.isArray(e)||(e=[e]);for(const s of e)this.observe(s)}observe(t){this.observer=new IntersectionObserver(e=>{const s=e[0];s.isIntersecting?"ifIntoView"in this.options&&this.options.ifIntoView.call(t):"ifOutOfView"in this.options&&this.options.ifOutOfView.call(t)},{rootMargin:`-${this.options.offset}px`}),this.observer.observe(t)}destroy(){this.observer&&this.observer.disconnect()}}e["b"]=i},6484:function(t,e,s){},6844:function(t,e,s){"use strict";var i=s("bc7c"),a=s.n(i);a.a},"6de8":function(t,e,s){"use strict";var i=s("f474"),a=s.n(i);a.a},"737a":function(t,e,s){"use strict";var i=s("5c0d");function a(t=!1,e="js-voa-start"){const s={targets:document.getElementsByClassName(e),offset:100,ifIntoView(){t?this.classList.add(e):this.classList.remove(e)}};return new i["b"](s)}e["a"]=a},"7d55":function(t,e,s){"use strict";var i=s("1a9b"),a=s.n(i);a.a},8875:function(t,e,s){"use strict";var i=s("9ab4"),a=s("2b0e"),n=s("3653"),r=s("34dd"),l=s("51a1");const o=a["default"].extend({computed:{...r["b"].mapGetters(["loadingError"])}});let c=class extends(Object(n["Mixins"])(o,l["a"])){constructor(){super(...arguments),this.requestStatus="failFetchList",this.titles={success:"Готово!",fail:"Ошибка!"},this.statuses={success:[],fail:["failFetchList","failFetchCurrentNews","failPublish","failDelete"]},this.btns={successFetchList:{firstBtn:"Закрыть"},successFetchCurrentNews:{firstBtn:"Закрыть"},successPublish:{firstBtn:"Закрыть"},successDelete:{firstBtn:"Закрыть"},failFetchList:{firstBtn:"Повторить попытку",secondBtn:"К списку разделов"},failFetchCurrentNews:{firstBtn:"Повторить попытку",secondBtn:"Вернуться к списку"},failPublish:{firstBtn:"Повторить попытку",secondBtn:"Отмена"},failDelete:{firstBtn:"Повторить попытку",secondBtn:"Отмена"}}}get statusType(){for(const t in this.statuses)if(this.statuses[t].indexOf(this.requestStatus)>=0)return t}get msgBoxTitle(){return this.titles[this.statusType]}get msgBoxMsg(){return this.loadingError}get msgBoxBtns(){return this.btns[this.requestStatus]}get msgBoxContent(){return{title:this.msgBoxTitle,msg:this.msgBoxMsg||this.contentDefault,...this.msgBoxBtns}}};c=Object(i["a"])([n["Mixin"]],c),e["a"]=c},aeba:function(t,e,s){},afef:function(t,e,s){},bc7c:function(t,e,s){},c34a:function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"pagination-app"},[s("div",{staticClass:"pagination-app__container"},[s("el-pagination",{staticClass:"pagination-app__pag",attrs:{background:!t.isLtMd,layout:"prev, pager, next",total:t.total,"page-size":t.pageSize,currentPage:t.currentPage,"pager-count":t.pagerCount},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"current-change":t.onCurrentChange}}),s("el-select",{staticClass:"pagination-app__select",attrs:{value:t.pageSize,placeholder:t.pageSize.toString()},on:{change:t.onSelectChange}},t._l(t.options,(function(t,e){return s("el-option",{key:e,staticClass:"pagination-app__option",attrs:{value:t}})})),1)],1)])},a=[],n=s("9ab4"),r=s("60a3"),l=s("2623");const o=r["e"].extend({computed:{...l["b"].mapState(["breakpoint"])}});let c=class extends o{constructor(){super(...arguments),this.options=[10,25,50],this.currentPage=1}get isLtMd(){return"xs"===this.breakpoint||"sm"===this.breakpoint}onCurrentPageChange(t){this.onCurrentChange(t)}onCurrentChange(t){this.$emit("currentChange",t)}onSelectChange(t){this.$emit("pageSizeChange",t)}};Object(n["a"])([Object(r["c"])()],c.prototype,"total",void 0),Object(n["a"])([Object(r["c"])()],c.prototype,"pageSize",void 0),Object(n["a"])([Object(r["c"])()],c.prototype,"pagerCount",void 0),Object(n["a"])([Object(r["f"])("currentPage")],c.prototype,"onCurrentPageChange",null),c=Object(n["a"])([Object(r["a"])({})],c);var d=c,u=d,h=(s("fbdf"),s("0c7c")),b=Object(h["a"])(u,i,a,!1,null,"2bb8df13",null);e["a"]=b.exports},cee6:function(t,e,s){"use strict";var i=s("2e69"),a=s.n(i);a.a},d25c:function(t,e,s){"use strict";var i=s("aeba"),a=s.n(i);a.a},d495:function(t,e,s){},e8b9:function(t,e,s){"use strict";var i=s("afef"),a=s.n(i);a.a},efb7:function(t,e,s){},f474:function(t,e,s){},f706:function(t,e,s){"use strict";var i=s("efb7"),a=s.n(i);a.a},fbdf:function(t,e,s){"use strict";var i=s("d495"),a=s.n(i);a.a},fe36:function(t,e,s){"use strict";var i=s("118c"),a=s.n(i);a.a}}]);
//# sourceMappingURL=chunk-7580190f.9c6d118f.js.map