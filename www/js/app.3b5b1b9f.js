(function(e){function t(t){for(var a,r,o=t[0],l=t[1],c=t[2],m=0,u=[];m<o.length;m++)r=o[m],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&u.push(i[r][0]),i[r]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);d&&d(t);while(u.length)u.shift()();return n.push.apply(n,c||[]),s()}function s(){for(var e,t=0;t<n.length;t++){for(var s=n[t],a=!0,o=1;o<s.length;o++){var l=s[o];0!==i[l]&&(a=!1)}a&&(n.splice(t--,1),e=r(r.s=s[0]))}return e}var a={},i={app:0},n=[];function r(t){if(a[t])return a[t].exports;var s=a[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=e,r.c=a,r.d=function(e,t,s){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(s,a,function(t){return e[t]}.bind(null,a));return s},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var d=l;n.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("cd49")},1152:function(e,t,s){"use strict";var a=s("6525"),i=s.n(a);i.a},"23bb":function(e,t,s){"use strict";var a=s("8c9a"),i=s.n(a);i.a},5230:function(e,t,s){"use strict";var a=s("7b84"),i=s.n(a);i.a},"57ef":function(e,t,s){"use strict";(function(e){const s={};t["a"]=(t,a)=>{const i=e&&Object({NODE_ENV:"production",BASE_URL:"/"})&&!1;if(!t||!t.length)return void console.error(`>>> preloadImages error: no urls recieved. urls:  ${t}`);"string"===typeof t&&(t=[t]);const n=i&&a&&a.verbose;return new Promise(async(e,a)=>{const i=[];let r=0;for(const n of t){if(s[n]){i.push(s[n]),r++;continue}const e=new Image,t=new Promise((a,i)=>{e.onload=()=>{a(e),s[n]=t},e.onerror=i,e.src=n});i.push(t)}const o=performance.now();let l=null;try{const s=await Promise.all(i);l=Math.round(performance.now()-o),n&&console.log(`preloadImages: ${t.length} images, ${r} taken from cache, loading time ${l}ms`,t),e(s)}catch(c){console.error(`>>> preloadImages error: ${c}`),a(c)}})}}).call(this,s("4362"))},"5dc0":function(e,t,s){},6525:function(e,t,s){},"740c":function(e,t,s){"use strict";var a=s("d3b7"),i=s.n(a);i.a},"7b84":function(e,t,s){},"7de4":function(e,t,s){},"7e27":function(e,t,s){},"7faf":function(e,t,s){"use strict";var a=s("7e27"),i=s.n(a);i.a},"88c7":function(e,t,s){"use strict";var a=s("e5ed"),i=s.n(a);i.a},"8c9a":function(e,t,s){},"8e91":function(e,t,s){"use strict";var a=s("c158"),i=s.n(a);i.a},"900a":function(e,t,s){"use strict";var a=s("7de4"),i=s.n(a);i.a},"98f2":function(e,t,s){},a970:function(e,t,s){"use strict";var a=s("f2ae"),i=s.n(a);i.a},b418:function(e,t,s){"use strict";var a=s("dc38"),i=s.n(a);i.a},c158:function(e,t,s){},cd49:function(e,t,s){"use strict";s.r(t);var a=s("2b0e"),i=s("8c4f");a["default"].use(i["a"]);var n=new i["a"]({mode:"history",routes:[]}),r=s("2f62");a["default"].use(r["b"]);var o=new r["b"].Store({}),l=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"app"},[s("div",{staticClass:"app__container container"},[s("transition",{attrs:{mode:"out-in"}},[e.isPageHome?s("div",{staticClass:"app__btn-wrapper"},[s("ButtonApp",{staticClass:"app__btn",attrs:{text:"Enter BannersModule"},on:{clicked:e.onClick}})],1):s("router-view",{staticClass:"app__page page"})],1)],1)])},c=[],d=s("9ab4"),m=s("60a3"),u=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"button-app"},[s("div",{staticClass:"button-app__container",class:[e.btnType,{"is-plain":e.isPlain,"is-disabled":e.disabled}],on:{click:e.onClick}},[s("div",{staticClass:"button-app__text",domProps:{innerHTML:e._s(e.text)}})])])},p=[];let h=class extends m["e"]{onClick(){this.disabled||this.$emit("clicked")}};Object(d["a"])([Object(m["c"])({default:"primary"})],h.prototype,"btnType",void 0),Object(d["a"])([Object(m["c"])()],h.prototype,"isPlain",void 0),Object(d["a"])([Object(m["c"])()],h.prototype,"text",void 0),Object(d["a"])([Object(m["c"])()],h.prototype,"disabled",void 0),h=Object(d["a"])([Object(m["a"])({})],h);var f=h,v=f,g=(s("a970"),s("0c7c")),b=Object(g["a"])(v,u,p,!1,null,"805de368",null),_=b.exports;let B=class extends m["e"]{get isPageHome(){return this.$route&&"/"===this.$route.fullPath}onClick(){this.$router.push({path:"/banners"})}};B=Object(d["a"])([Object(m["a"])({components:{ButtonApp:_}})],B);var C=B,y=C,I=(s("7faf"),Object(g["a"])(y,l,c,!1,null,null,null)),F=I.exports,w=s("675f"),x={namespaced:!0,state:{},getters:{},mutations:{},actions:{initializeModule({dispatch:e},t){Object(w["f"])(o,[t.name],`${t.name}/`,t.store),n.addRoutes(t.routes)},removeModule({dispatch:e},t){o.unregisterModule(t.name)}}},k=[],T={name:"banners",store:x,routes:k},S=s("5c96"),O=s.n(S),A=(s("0fae"),s("bc3a")),M=s.n(A);const j=M.a.create({headers:{Authorization:"Bearer SjXGagud3addBJsyBNtEsrxRqnyNLsVsr296afaB"}});var P=j;const L=!0;class D{constructor(){this.isLoading=!1,this.list=null,this.form={type:null,validationIsShown:!1,errors:[{type:"empty",msg:"Поле не должно быть пустым"},{type:"default",msg:"Недопустимое значение"}],data:[{name:"activeFrom",value:null,validationRequired:!1,isValid:!1,errorType:null,errorMsg:null},{name:"activeTo",value:null,validationRequired:!1,isValid:!1,errorType:null,errorMsg:null},{name:"isActive",value:!0,validationRequired:!1,isValid:!0,errorType:null,errorMsg:null},{name:"file",value:null,validationRequired:!0,isValid:!1,errorType:null,errorMsg:null},{name:"newsId",value:null,validationRequired:!1,isValid:!1,errorType:null,errorMsg:null},{name:"pageType",value:null,validationRequired:!0,isValid:!1,errorType:null,errorMsg:null},{name:"sort",value:4,validationRequired:!0,isValid:!0,errorType:null,errorMsg:null}]},this.activeAmount=4}}class $ extends w["b"]{get listSorted(){const e=this.state.list;if(!e||!e.length)return;const t=e.sort((e,t)=>{const s=e.isActive,a=t.isActive,i=e.sort,n=t.sort;return s===a?i<n?1:i>n?-1:0:s?-1:1}),s=t.filter(e=>e.isActive).map(e=>e.sort);return t.forEach(e=>{e.newsId="news"!==e.pageType?null:Number(V(e.appLink)),e.sortCalculated=e.isActive?s.indexOf(e.sort)+1:null}),t}get listActive(){return this.getters.listSorted.filter(e=>e.isActive)}get listInactive(){return this.getters.listSorted.filter(e=>!e.isActive)}get bannerById(){return e=>this.getters.listSorted&&this.getters.listSorted.find(t=>t.id.toString()===e.toString())}get formActiveFrom(){return this.state.form.data.find(e=>"activeFrom"===e.name)}get formActiveTo(){return this.state.form.data.find(e=>"activeTo"===e.name)}get formIsActive(){return this.state.form.data.find(e=>"isActive"===e.name)}get formFile(){return this.state.form.data.find(e=>"file"===e.name)}get formNewsId(){return this.state.form.data.find(e=>"newsId"===e.name)}get formPageType(){return this.state.form.data.find(e=>"pageType"===e.name)}get formSort(){return this.state.form.data.find(e=>"sort"===e.name)}get formIsValid(){const e=this.state.form.data.filter(e=>e.validationRequired);return e.every(e=>e.isValid)}get formData(){const e=Object.assign({});return e.activeForm=this.getters.formActiveFrom.value&&this.getters.formActiveFrom.value.toString()||"",e.activeTo=this.getters.formActiveTo.value&&this.getters.formActiveTo.value.toString()||"",e.isActive=this.getters.formIsActive.value&&this.getters.formIsActive.value.toString()||"",e.newsId=this.getters.formNewsId.value&&this.getters.formNewsId.value.toString()||"",e.pageType=this.getters.formPageType.value&&this.getters.formPageType.value.toString()||"",e.sort=this.getters.formIsActive.value&&this.getters.formSort.value&&this.getters.formSort.value.toString()||"",this.getters.formFile.value&&this.getters.formFile.value.type?e.file=this.getters.formFile.value:e.file=null,e}get preparedFormData(){const e=new FormData;return Object.keys(this.getters.formData).forEach(t=>{const s=this.getters.formData[t];(s||"create"===this.state.form.type)&&e.append(t,s)}),e}}class E extends w["d"]{setIsLoading(e){this.state.isLoading=e}saveList(e){this.state.list=e}setFormType(e){this.state.form.type=e}setValidationIsShown(e){this.state.form.validationIsShown=e}clearForm(){const e=this.state.form.data;e.forEach(e=>{e.value="isActive"===e.name||("sort"===e.name?this.state.activeAmount:null),e.isValid="sort"===e.name,e.validationRequired="file"===e.name||"pageType"===e.name||"sort"===e.name,e.errorType=!e.value&&e.validationRequired?"empty":"default",e.errorMsg=e.errorType&&this.state.form.errors.find(t=>t.type===e.errorType).msg}),this.state.form.validationIsShown=!1}handleFormErrors(e){const t=Object.keys(e);if(t&&t.length)for(const s of t){const t=this.state.form.data.find(e=>e.name===s);t.errorMsg=e[s],t.isValid=!1}}}class q extends w["a"]{updateField({name:e,value:t}){const s=this.state.form.data.find(t=>t.name===e);switch(s.value=t,e){case"isActive":const e=this.state.form.data.find(e=>"sort"===e.name);s.value?(e.validationRequired=!0,this.dispatch("updateField",{name:"sort",value:e.value})):(e.validationRequired=!1,this.dispatch("updateField",{name:"sort",value:null})),s.isValid=!!s.value;break;case"newsId":const t=this.state.form.data.find(e=>"pageType"===e.name);"news"!==t.value&&(s.validationRequired=!1),s.isValid=!!s.value;break;case"pageType":const a=this.state.form.data.find(e=>"newsId"===e.name);"news"===s.value?(a.validationRequired=!0,this.dispatch("updateField",{name:"newsId",value:a.value})):a.validationRequired=!1,s.isValid=!!s.value;break;case"sort":s.value=s.value>this.state.activeAmount||!s.value?this.state.activeAmount:s.value;const i=this.state.form.data.find(e=>"isActive"===e.name);i.value?s.validationRequired=!0:s.validationRequired=!1,s.isValid=!i.value||!!s.value;break;default:s.isValid=!!s.value}s.errorType=!s.value&&s.validationRequired&&"empty",s.errorMsg=s.errorType&&this.state.form.errors.find(e=>e.type===s.errorType).msg||""}async getList(){return new Promise((e,t)=>{this.commit("setIsLoading",!0),P.get("/api/v1/banners-list").then(t=>{while(!Array.isArray(t))t=t.data;this.commit("saveList",t),e()}).catch(e=>{console.log(e.response),t()}).finally(()=>{this.commit("setIsLoading",!1)})})}async createBanner(){return new Promise((e,t)=>{const s=this.getters.formIsValid;if(!s)return this.commit("setValidationIsShown",!0),void t();this.commit("setIsLoading",!0);const a=this.getters.preparedFormData;P.post("/api/v1/banner",a).then(t=>{this.commit("setValidationIsShown",!1),e(t.data.id)}).catch(e=>{if(console.log(e.response),this.commit("setValidationIsShown",!0),e.response.data&&e.response.data.errors){const s=e.response.data.errors;s.bannerId?t({bannerId:s.bannerId}):(this.commit("handleFormErrors",s),t())}}).finally(()=>{this.commit("setIsLoading",!1)})})}editBanner(e){return new Promise((t,s)=>{const a=this.getters.formIsValid;if(!a)return this.commit("setValidationIsShown",!0),void s();this.commit("setIsLoading",!0);const i=this.getters.preparedFormData;P.put(`/api/v1/banner/${e}`,i).then(e=>{this.commit("setValidationIsShown",!1),t(e.data.id)}).catch(e=>{if(console.log(e.response),this.commit("setValidationIsShown",!0),e.response.data&&e.response.data.errors){const t=e.response.data.errors;t.bannerId?s({bannerId:t.bannerId}):(this.commit("handleFormErrors",e.response.data.errors),s(e.response))}}).finally(()=>{this.commit("setIsLoading",!1)})})}deleteBanner(e){return new Promise((t,s)=>{this.commit("setIsLoading",!0),P.delete(`/api/v1/banner/${e}`).then(()=>t()).catch(e=>{console.log(e.response),s()}).finally(()=>{this.commit("setIsLoading",!1)})})}getBannerById(e){return new Promise((t,s)=>{this.commit("setIsLoading",!0),P.get(`/api/v1/banner/${e}`).then(e=>{const s=e.data;s.newsId="news"!==s.pageType?null:Number(V(s.appLink)),t(s)}).catch(e=>{console.log(e.response),s()}).finally(()=>{this.commit("setIsLoading",!1)})})}updateFormByBannerData(e){const t=this.state.form.data;t.forEach(t=>{switch(t.name){case"activeFrom":this.dispatch("updateField",{name:t.name,value:e.activeFrom});break;case"activeTo":this.dispatch("updateField",{name:t.name,value:e.activeTo});break;case"isActive":this.dispatch("updateField",{name:t.name,value:e.isActive});break;case"file":this.dispatch("updateField",{name:t.name,value:e.bannerImageUrl});break;case"newsId":this.dispatch("updateField",{name:t.name,value:e.newsId});break;case"pageType":this.dispatch("updateField",{name:t.name,value:e.pageType});break;case"sort":this.dispatch("updateField",{name:t.name,value:e.sortCalculated});break}})}deactivateBanner(e){return new Promise((t,s)=>{this.commit("setIsLoading",!0),P.post(`/api/v1/inactivate/${e}`).then(()=>t()).catch(()=>{this.commit("setIsLoading",!1),s()}).finally()})}}const V=e=>{const t=/\d+$/;return t.exec(e)[0]},R=new w["c"]({namespaced:L,state:D,getters:$,mutations:E,actions:q}),N=Object(w["e"])(R);var U=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.isLoading,expression:"isLoading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"page-main page"},[s("div",{staticClass:"page-main__container"},[s("h1",{staticClass:"page-main__title page-title"},[e._v("Список баннеров")]),s("ButtonApp",{staticClass:"page-main__btn",attrs:{text:"Создать баннер"},on:{clicked:e.onCreateClick}}),s("ListBanners",{key:e.listSorted&&e.listSorted.length,staticClass:"page-main__list",on:{deleteItem:e.onDeleteClick}})],1),s("transition",[s("MessageBox",{directives:[{name:"show",rawName:"v-show",value:e.msgBoxIsShown,expression:"msgBoxIsShown"}],staticClass:"page-main__msg-box modal",attrs:{content:e.msgBoxContent,secondBtn:e.secondBtn},on:{close:e.closeMsgBox,firstBtnClicked:e.onFirstBtnClick,secondBtnClicked:e.closeMsgBox}})],1)],1)},H=[],G=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"list-banners"},[e.list&&e.list.length?s("div",{staticClass:"list-banners__container"},[s("el-menu",{staticClass:"list-banners__sort",attrs:{"default-active":e.activeIndex,mode:"horizontal"},on:{select:e.handleSelect}},e._l(e.sortItems,(function(t,a){return s("el-menu-item",{key:a,staticClass:"list-banners__sort-item",attrs:{index:(a+1).toString()},domProps:{innerHTML:e._s(t)}})})),1),s("transition",{attrs:{mode:"out-in"},on:{enter:e.animateOneMoreTime}},[s("div",{key:e.activeIndex,staticClass:"list-banners__items"},[e._l(e.activeList,(function(t,a){return s("ItemBanner",{key:t.id,staticClass:"list-banners__item js-voa js-voa-start",attrs:{banner:t},on:{delete:e.onDeleteItem}})})),e._l(3,(function(e){return s("div",{staticClass:"list-banners__item list-banners__item_fake"})}))],2)])],1):e._e()])},z=[],J=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"item-banner"},[s("div",{staticClass:"item-banner__container"},[e.editIconsShown?s("div",{staticClass:"item-banner__icons"},[s("div",{staticClass:"item-banner__icon",class:{"is-active":!e.deleteHovered},on:{click:e.onEditClick,mouseenter:function(t){e.editHovered=!0},mouseleave:function(t){e.editHovered=!1}}},[s("i",{staticClass:"el-icon-edit"})]),s("div",{staticClass:"item-banner__icon",class:{"is-active":!e.editHovered},on:{click:e.onDeleteClick,mouseenter:function(t){e.deleteHovered=!0},mouseleave:function(t){e.deleteHovered=!1}}},[s("i",{staticClass:"el-icon-delete"})])]):e._e(),s("div",{staticClass:"item-banner__img-wrapper"},[s("transition",{attrs:{mode:"in-out"}},[e.imgLoaded?s("IMG",{staticClass:"item-banner__img",attrs:{src:e.banner.bannerImageUrl}}):s("div",{staticClass:"item-banner__img item-banner__img_loading"})],1)],1),s("div",{staticClass:"item-banner__info"},[e.banner.appLink?s("div",{staticClass:"item-banner__info-item"},[s("div",{staticClass:"item-banner__title"},[e._v("Ссылка: "),s("span",{staticClass:"item-banner__text"},[e._v(e._s(e.banner.appLink))])])]):e._e(),e.banner.sortCalculated&&e.banner.isActive?s("div",{staticClass:"item-banner__info-item"},[s("div",{staticClass:"item-banner__title"},[e._v("Порядок вывода: "),s("span",{staticClass:"item-banner__text"},[e._v(e._s(e.banner.sortCalculated))])])]):e._e(),s("div",{staticClass:"item-banner__info-item"},[s("div",{staticClass:"item-banner__title"},[e._v("Отображать в приложении: "),s("span",{staticClass:"item-banner__text"},[e._v(e._s(e.banner.isActive?"Да":"Нет"))])])]),e.banner.activeFrom||e.banner.activeTo?s("div",{staticClass:"item-banner__info-item"},[s("div",{staticClass:"item-banner__title"},[e._v("Срок действия: ")]),s("div",{staticClass:"item-banner__text"},[e._v(e._s(e.banner.activeFrom+" — "+e.banner.activeTo))])]):e._e()])])])},X=[],Y=s("57ef");let K=class extends m["e"]{constructor(){super(...arguments),this.imgLoaded=!1,this.editHovered=!1,this.deleteHovered=!1}created(){Object(Y["a"])(this.banner.bannerImageUrl).then(async()=>{this.imgLoaded=!0})}onEditClick(){this.$router.push({path:`/banners/edit/${this.banner.id.toString()}`})}onDeleteClick(){this.$emit("delete",this.banner.id)}};Object(d["a"])([Object(m["c"])()],K.prototype,"banner",void 0),Object(d["a"])([Object(m["c"])({default:!0})],K.prototype,"editIconsShown",void 0),K=Object(d["a"])([Object(m["a"])({})],K);var Q=K,W=Q,Z=(s("900a"),Object(g["a"])(W,J,X,!1,null,"34da0a4e",null)),ee=Z.exports;class te{constructor(e){this.options=e;let t=e.targets;(t instanceof NodeList||t instanceof HTMLCollection)&&(t=Array.from(t)),Array.isArray(t)||(t=[t]);for(const s of t)this.observe(s)}observe(e){this.observer=new IntersectionObserver(t=>{const s=t[0];s.isIntersecting?"ifIntoView"in this.options&&this.options.ifIntoView.call(e):"ifOutOfView"in this.options&&this.options.ifOutOfView.call(e)},{rootMargin:`-${this.options.offset}px`}),this.observer.observe(e)}destroy(){this.observer&&this.observer.disconnect()}}var se=te;function ae(e=!1,t="js-voa-start"){const s={targets:document.getElementsByClassName(t),offset:100,ifIntoView(){e?this.classList.add(t):this.classList.remove(t)}};return new se(s)}var ie=ae;const ne=m["e"].extend({computed:{...N.mapGetters(["listSorted","listActive","listInactive"])}});let re=class extends ne{constructor(){super(...arguments),this.activeIndex="1"}get list(){return this.listSorted}get activeList(){return"2"===this.activeIndex?this.listActive:"3"===this.activeIndex?this.listInactive:this.list}get sortItems(){return[`Все баннеры (${this.list.length})`,`Активные (${this.listActive.length})`,`Неактивные (${this.listInactive.length})`]}async mounted(){await this.$nextTick(),ie()}handleSelect(e){this.activeIndex=e}onDeleteItem(e){this.$emit("deleteItem",e)}animateOneMoreTime(){ie()}};re=Object(d["a"])([Object(m["a"])({components:{ItemBanner:ee}})],re);var oe=re,le=oe,ce=(s("b418"),Object(g["a"])(le,G,z,!1,null,"1cb625ee",null)),de=ce.exports,me=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"msg-box"},[s("div",{staticClass:"msg-box__container"},[s("div",{staticClass:"msg-box__header"},[e.content&&e.content.title?s("div",{staticClass:"msg-box__title"},[e._v(e._s(e.content.title))]):e._e(),s("div",{staticClass:"msg-box__btn-close",on:{click:e.onCloseClick}},[s("i",{staticClass:"el-icon-close msg-box__icon-close"})])]),e.content&&e.content.msg?s("div",{staticClass:"msg-box__content"},[e._v(e._s(e.content.msg))]):e._e(),s("div",{staticClass:"msg-box__btns"},[e.content&&e.content.firstBtn?s("ButtonApp",{staticClass:"msg-box__btn",attrs:{btnType:e.firstBtn.type,isPlain:e.firstBtn.isPlain,text:e.content.firstBtn},on:{clicked:e.onFirstBtnClick}}):e._e(),e.content&&e.content.secondBtn?s("ButtonApp",{staticClass:"msg-box__btn",attrs:{btnType:e.secondBtn.type,isPlain:e.secondBtn.isPlain,text:e.content.secondBtn},on:{clicked:e.onSecondBtnClick}}):e._e()],1)])])},ue=[];let pe=class extends m["e"]{onCloseClick(){this.$emit("close")}onFirstBtnClick(){this.$emit("firstBtnClicked")}onSecondBtnClick(){this.$emit("secondBtnClicked")}};Object(d["a"])([Object(m["c"])()],pe.prototype,"content",void 0),Object(d["a"])([Object(m["c"])({default:function(){return{type:"primary",isPlain:!1}}})],pe.prototype,"firstBtn",void 0),Object(d["a"])([Object(m["c"])({default:function(){return{type:"success",isPlain:!0}}})],pe.prototype,"secondBtn",void 0),pe=Object(d["a"])([Object(m["a"])({components:{ButtonApp:_}})],pe);var he=pe,fe=he,ve=(s("23bb"),Object(g["a"])(fe,me,ue,!1,null,"1e5ce999",null)),ge=ve.exports,be=s("3653");let _e=class extends a["default"]{constructor(){super(...arguments),this.msgBoxIsShown=!1,this.requestStatus="failFetchList",this.msgBoxContents={successFetchList:{title:"Готово!",msg:"Данные успешно загружены",firstBtn:"Закрыть"},failFetchList:{title:"Ошибка!",msg:"Не удалось получить ответ от сервера",firstBtn:"Повторить попытку"},successFetchBanner:{title:"Готово!",msg:"Данные успешно загружены",firstBtn:"Закрыть"},failFetchBanner:{title:"Данные не найдены",msg:"Вероятно баннер был удален ранее",firstBtn:"Вернуться к списку"},successCreate:{title:"Готово!",msg:"Данные успешно сохранены",firstBtn:"Отредактировать баннер",secondBtn:"Вернуться к списку"},failCreate:{title:"Ошибка при отправке",msg:"Не удалось отправить данные",firstBtn:"Отправить повторно",secondBtn:"Отменить"},successEdit:{title:"Готово!",msg:"Данные успешно сохранены",firstBtn:"Продолжить редактирование",secondBtn:"Вернуться к списку"},failEdit:{title:"Ошибка при отправке",msg:"Не удалось отправить данные",firstBtn:"Отправить повторно",secondBtn:"Отменить"},successDelete:{title:"Готово!",msg:"Данные успешно удалены",firstBtn:"Вернуться к списку"},failDelete:{title:"Ошибка при удалении",msg:"Возможно информация уже была удалена",firstBtn:"Повторить попытку",secondBtn:"Отменить"},beforeDelete:{title:"Вы уверены?",msg:"Данное действие нельзя отменить",firstBtn:"Подтвердить",secondBtn:"Отмена"},failDeactivate:{title:"Ошибка!",msg:"Не удалось заменить баннер",firstBtn:"Повторить попытку",secondBtn:"Отмена"}}}get msgBoxContent(){return this.msgBoxContents[this.requestStatus]}created(){document.addEventListener("keydown",this.keydownHandler)}beforeDestroy(){document.body.classList.remove("modal-open"),document.removeEventListener("keydown",this.keydownHandler)}keydownHandler(e){"Escape"===e.key&&this.msgBoxIsShown&&this.closeMsgBox()}openMsgBox(){document.body.classList.add("modal-open"),this.msgBoxIsShown=!0}closeMsgBox(){document.body.classList.remove("modal-open"),this.msgBoxIsShown=!1}};_e=Object(d["a"])([be["Mixin"]],_e);var Be=_e;function Ce(e){return new Promise(t=>setTimeout(()=>t(!0),e))}var ye=Ce;const Ie=m["e"].extend({computed:{...N.mapState(["isLoading"]),...N.mapGetters(["listSorted"])},methods:{...N.mapActions(["getList","deleteBanner"])}});let Fe=class extends(Object(m["b"])(Be,Ie)){constructor(){super(...arguments),this.deleteId=null,this.secondBtn=null}created(){this.updateList()}onCreateClick(){this.$router.push({path:"/banners/create"})}onDeleteClick(e){e&&(this.deleteId=e),this.secondBtn={type:"danger",isPlain:!0},this.requestStatus="beforeDelete",this.openMsgBox()}onFirstBtnClick(){switch(this.requestStatus){case"beforeDelete":this.closeMsgBox(),this.deleteItem();case"failFetchList":this.updateList();default:this.closeMsgBox()}}deleteItem(){this.deleteBanner(this.deleteId).then(async()=>{this.secondBtn={type:"success",isPlain:!0},this.requestStatus="successDelete",this.openMsgBox(),this.deleteId=null,this.updateList(),await ye(1500),this.closeMsgBox()}).catch(()=>{this.secondBtn={type:"danger",isPlain:!0},this.requestStatus="failDelete",this.updateList(),this.openMsgBox()})}updateList(){this.$emit("updateList")}};Fe=Object(d["a"])([Object(m["a"])({components:{ListBanners:de,MessageBox:ge,ButtonApp:_},mixins:[Be]})],Fe);var we=Fe,xe=we,ke=(s("fe6c"),Object(g["a"])(xe,U,H,!1,null,"49204aba",null)),Te=ke.exports,Se=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.isLoading,expression:"isLoading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"page-create page"},[s("div",{staticClass:"page-create__container"},[s("div",{staticClass:"page-create__row-back",on:{click:e.goToPageMain}},[s("i",{staticClass:"el-icon-back page-create__icon-back"}),s("div",{staticClass:"page-create__text-back"},[e._v("Вернуться к списку")])]),s("div",{staticClass:"page-create__form-wrapper"},[s("h1",{staticClass:"page-create__title page-title"},[e._v("Создание баннера")]),s("FormBanners",{staticClass:"page-create__form"}),s("div",{staticClass:"page-create__btns"},[s("ButtonApp",{staticClass:"page-create__btn",attrs:{btnType:"primary",disabled:!e.isSmthToCommit,text:"Сохранить баннер"},on:{clicked:e.submitForm}}),s("ButtonApp",{staticClass:"page-create__btn",attrs:{btnType:"warning",disabled:!e.isSmthToCommit,isPlain:!0,text:"Очистить форму"},on:{clicked:e.clearForm}}),s("ButtonApp",{staticClass:"page-create__btn",attrs:{btnType:"danger",isPlain:!0,text:"Отменить"},on:{clicked:e.goToPageMain}})],1)],1)]),s("transition-group",{attrs:{tag:"div"}},[s("MessageBox",{directives:[{name:"show",rawName:"v-show",value:e.msgBoxIsShown,expression:"msgBoxIsShown"}],key:"msg",staticClass:"page-create__msg-box modal",attrs:{content:e.msgBoxContent,secondBtn:e.secondBtn},on:{close:e.closeMsgBox,firstBtnClicked:e.onFirstBtnClick,secondBtnClicked:e.onSecondBtnClick}}),e.popupFormIsShown&&e.bannerConflict?s("PopupForm",{key:"popup",staticClass:"page-create__popup modal",attrs:{banner:e.bannerConflict},on:{confirm:e.deactivateBannerConflict,discard:e.closePopupForm}}):e._e()],1)],1)},Oe=[],Ae=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"form-banners"},[s("div",{staticClass:"form-banners__container"},[s("div",{staticClass:"form-banners__column"},[s("div",{staticClass:"form-banners__field form-banners__field_img",class:{"is-invalid":e.isInvalid(e.fileField)}},[s("DragDrop",{staticClass:"form-banners__drag-drop"}),s("div",{staticClass:"form-banners__error",domProps:{innerHTML:e._s(e.fileField.errorMsg)}})],1)]),s("div",{staticClass:"form-banners__column"},[s("div",{staticClass:"form-banners__field form-banners__field_news-id",class:{"is-invalid":e.isInvalid(e.newsIdField),"is-filled":e.newsId}},[e._m(0),s("el-input",{staticClass:"form-banners__input",attrs:{placeholder:"000"},model:{value:e.newsId,callback:function(t){e.newsId=t},expression:"newsId"}}),s("div",{staticClass:"form-banners__error",domProps:{innerHTML:e._s(e.newsIdField.errorMsg)}})],1),s("div",{staticClass:"form-banners__field form-banners__field_page-type",class:{"is-invalid":e.isInvalid(e.pageTypeField),"is-filled":!!e.pageType}},[e._m(1),s("el-input",{staticClass:"form-banners__input",attrs:{placeholder:"type"},model:{value:e.pageType,callback:function(t){e.pageType=t},expression:"pageType"}}),s("div",{staticClass:"form-banners__error",domProps:{innerHTML:e._s(e.pageTypeField.errorMsg)}})],1),s("div",{staticClass:"form-banners__field form-banners__field_is-active",class:{"is-invalid":e.isInvalid(e.isActiveField)}},[s("label",{staticClass:"form-banners__label",attrs:{for:"isActive"}},[e._v("Показывать в приложении")]),s("el-checkbox",{staticClass:"form-banners__checkbox",model:{value:e.isActive,callback:function(t){e.isActive=t},expression:"isActive"}}),s("div",{staticClass:"form-banners__error",domProps:{innerHTML:e._s(e.isActiveField.errorMsg)}})],1),s("div",{staticClass:"form-banners__field form-banners__field_sort",class:{"is-invalid":e.isInvalid(e.sortField),"is-filled":e.sortBy&&e.isActive}},[s("label",{staticClass:"form-banners__label",attrs:{for:"sortBy"}},[e._v("Положение баннера")]),s("el-select",{ref:"select",staticClass:"form-banners__select",attrs:{disabled:!e.isActive,placeholder:e.activeAmount.toString()},model:{value:e.sortBy,callback:function(t){e.sortBy=t},expression:"sortBy"}},e._l(e.activeAmount,(function(e){return s("el-option",{key:e,attrs:{label:e,value:e}})})),1),s("div",{staticClass:"form-banners__error",domProps:{innerHTML:e._s(e.sortField.errorMsg)}})],1)])])])},Me=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"form-banners__label"},[s("label",{attrs:{for:"newsId"}},[e._v("Id новости")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"form-banners__label"},[s("label",{attrs:{for:"pageType"}},[e._v("Тип страницы")])])}],je=s("a64a"),Pe=s.n(je),Le=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"drag-drop"},[s("transition-group",{staticClass:"drag-drop__container",class:{"is-filled":!!e.file},attrs:{tag:"div"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:!e.file,expression:"!file"}],key:"loaders",staticClass:"drag-drop__loaders"},[s("i",{staticClass:"el-icon-plus drag-drop__drop-plus"}),s("div",{staticClass:"drag-drop__drop",on:{drop:function(t){return t.preventDefault(),e.onDropImg(t)}}}),s("input",{ref:"fileinput",staticClass:"drag-drop__input-img",attrs:{type:"file"},on:{input:e.onInputImg}})]),!e.imgLoaded&&e.imgUrl?s("div",{key:"loading",staticClass:"drag-drop__img-preview drag-drop__img-preview_loading"}):e._e(),s("div",{directives:[{name:"show",rawName:"v-show",value:e.file,expression:"file"}],key:"img",staticClass:"drag-drop__img",on:{mouseenter:function(t){if(t.target!==t.currentTarget)return null;e.dropDeleteIsShown=!0},mouseleave:function(t){e.dropDeleteIsShown=!1},click:e.removeImg}},[s("transition",{attrs:{mode:"in-out"}},[e.imgLoaded?s("IMG",{staticClass:"drag-drop__img-preview",class:{"is-faded":e.dropDeleteIsShown},attrs:{src:e.imgUrl}}):e._e()],1),s("i",{directives:[{name:"show",rawName:"v-show",value:e.dropDeleteIsShown,expression:"dropDeleteIsShown"}],staticClass:"el-icon-delete-solid drag-drop__drop-delete"})],1)])],1)},De=[];const $e=m["e"].extend({computed:{...N.mapGetters(["formFile","bannerById"])},methods:{...N.mapActions(["updateField"])}});let Ee=class extends $e{constructor(){super(...arguments),this.imgUrl="",this.dropDeleteIsShown=!1,this.imgLoaded=!1}get fileField(){return this.formFile}get file(){return this.fileField.value}set file(e){this.updateFile(e)}get banner(){return this.bannerById(Number(this.$route.params.id))}get bannerImgUrl(){return this.banner&&this.banner.bannerImageUrl}onFileChange(e){e&&this.getImagePreviews()}created(){this.imgUrl&&Object(Y["a"])(this.imgUrl).then(()=>this.imgLoaded=!0)}onImgUrlChange(e){e&&(this.imgLoaded=!1,Object(Y["a"])(this.imgUrl).then(()=>this.imgLoaded=!0))}updateFile(e){return this.updateField({name:"file",value:e})}onDropImg(e){this.file=e.dataTransfer&&e.dataTransfer.files[0]}onInputImg(e){const t=e.target;this.file=t.files&&t.files[0]}getImagePreviews(){if(this.file.type){let e=new FileReader;e.addEventListener("load",()=>this.imgUrl=e.result,!1),e.readAsDataURL(this.file)}else this.imgUrl=this.file}removeImg(){this.updateFile(null),this.fileinput.value="",this.imgUrl=null,this.dropDeleteIsShown=!1}};Object(d["a"])([Object(m["d"])()],Ee.prototype,"fileinput",void 0),Object(d["a"])([Object(m["f"])("file",{immediate:!0})],Ee.prototype,"onFileChange",null),Object(d["a"])([Object(m["f"])("imgUrl")],Ee.prototype,"onImgUrlChange",null),Ee=Object(d["a"])([Object(m["a"])({components:{}})],Ee);var qe=Ee,Ve=qe,Re=(s("740c"),Object(g["a"])(Ve,Le,De,!1,null,"c04b5f72",null)),Ne=Re.exports,Ue=s("cf06"),He=s.n(Ue),Ge=s("6ffc");const ze=m["e"].extend({computed:{...N.mapState(["form","activeAmount"]),...N.mapGetters(["listActive","formSort","formActiveFrom","formActiveTo","formIsActive","formFile","formNewsId","formPageType"])},methods:{...N.mapMutations(["setValidationIsShown"]),...N.mapActions(["updateField"])}});let Je=class extends ze{constructor(){super(...arguments),this.pickrFrom=null,this.pickrTo=null,this.dateFormat="d-m-Y H:i"}get activeFromField(){return this.formActiveFrom}get activeToField(){return this.formActiveTo}get isActiveField(){return this.formIsActive}get fileField(){return this.formFile}get newsIdField(){return this.formNewsId}get pageTypeField(){return this.formPageType}get sortField(){return this.formSort}get activeFrom(){return this.pickrFrom&&this.pickrFrom.selectedDates.length&&this.pickrFrom.formatDate(this.pickrFrom.selectedDates[0],this.dateFormat)}set activeFrom(e){this.updateField({name:"activeFrom",value:e})}get activeTo(){return this.pickrTo&&this.pickrTo.selectedDates.length&&this.pickrTo.formatDate(this.pickrTo.selectedDates[0],this.dateFormat)}set activeTo(e){this.updateField({name:"activeTo",value:e})}get isActive(){return this.isActiveField.value}set isActive(e){this.updateField({name:"isActive",value:e})}get newsId(){return this.newsIdField.value}set newsId(e){this.updateField({name:"newsId",value:Pe()(e)})}get pageType(){return this.pageTypeField.value}set pageType(e){this.updateField({name:"pageType",value:Pe()(e)})}get sortBy(){return this.isActive?this.sortField.value:null}set sortBy(e){this.isActive&&this.updateField({name:"sort",value:e||this.activeAmount})}mounted(){}beforeDestroy(){this.setValidationIsShown(!1)}initPickers(){const e={locale:Ge["Russian"],dateFormat:this.dateFormat,minDate:new Date,enableTime:!0,onChange:e=>{const t=this.pickrFrom.formatDate(e[0],this.dateFormat);this.pickrTo.selectedDates[0]&&this.pickrTo.selectedDates[0].getTime()<new Date(e).getTime()&&this.pickrTo.setDate(t),this.pickrTo.set("minDate",t)}};this.pickrFrom=He()(this.fromRef,e),this.activeFromField.value&&this.pickrFrom.setDate(this.activeFromField.value);const t={locale:Ge["Russian"],dateFormat:this.dateFormat,minDate:new Date,enableTime:!0};this.pickrTo=He()(this.toRef,t),this.activeToField.value&&this.pickrTo.setDate(this.activeToField.value)}isInvalid(e){return this.form.validationIsShown&&e.validationRequired&&!e.isValid}};Object(d["a"])([Object(m["d"])()],Je.prototype,"fromRef",void 0),Object(d["a"])([Object(m["d"])()],Je.prototype,"toRef",void 0),Je=Object(d["a"])([Object(m["a"])({components:{DragDrop:Ne}})],Je);var Xe=Je,Ye=Xe,Ke=(s("8e91"),Object(g["a"])(Ye,Ae,Me,!1,null,"028d634d",null)),Qe=Ke.exports,We=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"popup-form"},[s("div",{staticClass:"popup-form__container"},[e._m(0),s("ItemBanner",{staticClass:"popup-form__item",attrs:{banner:e.banner,editIconsShown:!1}}),s("div",{staticClass:"popup-form__btns"},[s("ButtonApp",{staticClass:"popup-form__btn",attrs:{btnType:"primary",text:"Заменить"},on:{clicked:e.confirm}}),s("ButtonApp",{staticClass:"popup-form__btn",attrs:{btnType:"danger",text:"Отмена"},on:{clicked:e.discard}})],1)],1)])},Ze=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"popup-form__text"},[e._v("Выбранное поле сортировки занято другим баннером."),s("br"),e._v("Хотите заменить этот баннер?")])}];const et=m["e"].extend({methods:{}});let tt=class extends(Object(m["b"])(et,Be)){confirm(){this.$emit("confirm")}discard(){this.$emit("discard")}};Object(d["a"])([Object(m["c"])()],tt.prototype,"banner",void 0),tt=Object(d["a"])([Object(m["a"])({components:{ItemBanner:ee,ButtonApp:_}})],tt);var st=tt,at=st,it=(s("5230"),Object(g["a"])(at,We,Ze,!1,null,"599acc6b",null)),nt=it.exports;const rt=m["e"].extend({computed:{...N.mapState(["isLoading","form","activeAmount"]),...N.mapGetters(["listSorted","listActive","formSort","bannerById","formIsValid"])},methods:{...N.mapMutations(["setFormType","clearForm"]),...N.mapActions(["getList","deleteBanner","createBanner","deactivateBanner"])}});let ot=class extends(Object(m["b"])(Be,rt)){constructor(){super(...arguments),this.bannerId=null,this.secondBtn=null,this.bannerConflictId=null,this.popupFormIsShown=!1}get bannerConflict(){return this.bannerById(this.bannerConflictId)}get isPageCreate(){return this.$route.path.includes("/banners/create")}get isSmthToCommit(){const e=this.form.data,t=e.find(e=>"sort"===e.name).value.toString()!==this.activeAmount.toString(),s=!e.find(e=>"isActive"===e.name).value,a=e.filter(e=>"isActive"!==e.name&&"sort"!==e.name).map(e=>e.value).some(e=>!!e);return t||a||s}created(){this.setFormType("create"),this.clearForm()}openPopupForm(){document.body.classList.add("modal-open"),this.popupFormIsShown=!0}closePopupForm(){document.body.classList.remove("modal-open"),this.popupFormIsShown=!1,this.bannerConflictId=null}onFirstBtnClick(){switch(this.requestStatus){case"successCreate":this.goToPageEdit();break;case"failDeactivate":this.deactivateBannerConflict();break;default:this.submitForm();break}}onSecondBtnClick(){switch(this.requestStatus){case"successCreate":this.goToPageMain();break;case"failDeactivate":this.closeMsgBox(),this.closePopupForm();break;default:this.closeMsgBox();break}}goToPageMain(){this.$router.push({path:"/banners/list"}).catch(e=>{})}goToPageEdit(){this.$router.push({path:`/banners/edit/${this.bannerId.toString()}`}).catch(e=>{})}submitForm(){this.createBanner().then(async e=>{this.bannerId=e,this.secondBtn={type:"success",isPlain:!0},this.requestStatus="successCreate",this.openMsgBox(),await this.getList(),await ye(1500),this.isPageCreate&&(this.closeMsgBox(),this.goToPageEdit())}).catch(e=>{this.formIsValid&&(e.bannerId?(this.bannerConflictId=e.bannerId,this.openPopupForm()):(this.secondBtn={type:"danger",isPlain:!0},this.requestStatus="failCreate",this.openMsgBox()))})}deactivateBannerConflict(){this.deactivateBanner(this.bannerConflictId).then(()=>{console.log("Success deactivate!"),this.closeMsgBox(),this.closePopupForm(),this.submitForm()}).catch(()=>{console.log("Fail deactivate :("),this.requestStatus="failDeactivate",this.secondBtn={type:"danger",isPlain:!0},this.openMsgBox()})}};ot=Object(d["a"])([Object(m["a"])({components:{FormBanners:Qe,MessageBox:ge,PopupForm:nt,ButtonApp:_}})],ot);var lt=ot,ct=lt,dt=(s("dd4d"),Object(g["a"])(ct,Se,Oe,!1,null,"9dbf7050",null)),mt=dt.exports,ut=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.isLoading,expression:"isLoading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"page-edit page"},[s("div",{staticClass:"page-edit__container"},[s("div",{staticClass:"page-edit__row-back",on:{click:e.goToPageMain}},[s("i",{staticClass:"el-icon-back page-edit__icon-back"}),s("div",{staticClass:"page-edit__text-back"},[e._v("Вернуться к списку")])]),s("div",{staticClass:"page-edit__form-wrapper"},[s("h1",{staticClass:"page-edit__title page-title"},[e._v("Редактирование баннера")]),s("FormBanners",{staticClass:"page-edit__form"}),s("div",{staticClass:"page-edit__btns"},[s("ButtonApp",{staticClass:"page-edit__btn",attrs:{btnType:"primary",disabled:!e.isSmthToUpdate,text:"Сохранить баннер"},on:{clicked:e.submitForm}}),s("ButtonApp",{staticClass:"page-edit__btn",attrs:{btnType:"warning",disabled:!e.isSmthToUpdate,isPlain:!0,text:"Сбросить изменения"},on:{clicked:e.resetForm}}),s("ButtonApp",{staticClass:"page-edit__btn",attrs:{btnType:"danger",isPlain:!0,text:"Удалить баннер"},on:{clicked:e.onClickDelete}}),s("ButtonApp",{staticClass:"page-edit__btn",attrs:{btnType:"success",isPlain:!0,text:"Отмена"},on:{clicked:e.goToPageMain}})],1)],1)]),s("transition-group",{attrs:{tag:"div"}},[s("MessageBox",{directives:[{name:"show",rawName:"v-show",value:e.msgBoxIsShown,expression:"msgBoxIsShown"}],key:"msg",staticClass:"page-edit__msg-box modal modal-msg",attrs:{content:e.msgBoxContent,secondBtn:e.secondBtn},on:{close:e.onCloseClick,firstBtnClicked:e.onFirstBtnClick,secondBtnClicked:e.onSecondBtnClick}}),e.popupFormIsShown&&e.bannerConflict?s("PopupForm",{key:"popup",staticClass:"page-edit__popup modal modal-popup",attrs:{banner:e.bannerConflict},on:{confirm:e.deactivateBannerConflict,discard:e.closePopupForm}}):e._e()],1)],1)},pt=[];m["a"].registerHooks(["beforeRouteEnter","beforeRouteUpdate"]);const ht=m["e"].extend({computed:{...N.mapState(["list","isLoading","form"]),...N.mapGetters(["bannerById","formIsValid","listActive","formSort"])},methods:{...N.mapMutations(["setFormType","clearForm","setIsLoading"]),...N.mapActions(["editBanner","deleteBanner","updateFormByBannerData","getBannerById","getList","deactivateBanner"])}});let ft=class extends(Object(m["b"])(Be,ht)){constructor(){super(...arguments),this.banner=null,this.secondBtn=null,this.bannerConflictId=null,this.popupFormIsShown=!1}get bannerConflict(){return this.bannerById(this.bannerConflictId)}get isSmthToUpdate(){if(!this.banner)return!1;const e=this.form.data,t=this.banner;for(const s of e)switch(s.name){case"file":if(!s.value||s.value.type)return!0;break;case"sort":if(e.find(e=>"isActive"===e.name).value)return t.sortCalculated!==s.value;break;default:if((t[s.name]&&t[s.name].toString())!==(s.value&&s.value.toString()))return!0}return!1}onListChanged(e){if(e){const e=Number(this.$route.params.id);this.banner=this.bannerById(e),this.banner&&this.updateFormByBannerData(this.banner)}}onBannerUpd(e){console.log(e)}created(){this.clearForm(),this.setFormType("edit");const e=Number(this.$route.params.id);this.banner=this.bannerById(e),this.banner?this.updateFormByBannerData(this.banner):this.setIsLoading(!0)}beforeDestroy(){this.clearForm()}onCloseClick(){switch(this.requestStatus){case"failFetchBanner":this.goToPageMain();break;default:this.closeMsgBox();break}}onFirstBtnClick(){switch(this.requestStatus){case"successEdit":this.closeMsgBox();break;case"failEdit":this.submitForm();break;case"failDelete":this.onClickDelete();break;case"failDeactivate":this.deactivateBannerConflict();break;case"failFetchBanner":case"successDelete":default:this.goToPageMain();break}}onSecondBtnClick(){switch(this.requestStatus){case"failCreate":case"failEdit":case"failDelete":this.closeMsgBox();break;case"failDeactivate":this.closeMsgBox(),this.closePopupForm();break;case"successEdit":default:this.goToPageMain();break}}onClickDelete(){this.deleteBanner(this.banner.id).then(async()=>{this.requestStatus="successDelete",this.secondBtn={type:"success",isPlain:!0},this.openMsgBox(),await ye(1500),this.goToPageMain(),this.closeMsgBox()}).catch(()=>{this.requestStatus="failDelete",this.secondBtn={type:"danger",isPlain:!0},this.openMsgBox()})}goToPageMain(){this.$router.push({path:"/banners/list"}).catch(e=>{})}updateBannerData(){}submitForm(){this.editBanner(this.banner.id).then(async()=>{this.requestStatus="successEdit",this.secondBtn={type:"success",isPlain:!0},this.openMsgBox(),await this.getList().then(async()=>{this.banner=this.bannerById(this.banner.id),this.updateFormByBannerData(this.banner),await ye(1500),this.closeMsgBox()})}).catch(e=>{this.formIsValid&&(e.bannerId?(this.bannerConflictId=e.bannerId,this.openPopupForm()):(this.requestStatus="failEdit",this.secondBtn={type:"danger",isPlain:!0},this.openMsgBox()))})}async resetForm(){this.clearForm(),this.banner||await this.getBannerById(Number(this.$route.params.id)).then(e=>{this.banner=e,this.closeMsgBox()}).catch(e=>{this.requestStatus="failFetchBanner",this.secondBtn={type:"danger",isPlain:!0},this.openMsgBox()}),this.banner&&this.updateFormByBannerData(this.banner)}deactivateBannerConflict(){this.deactivateBanner(this.bannerConflictId).then(()=>{console.log("Success deactivate!"),this.closeMsgBox(),this.closePopupForm(),this.submitForm()}).catch(()=>{console.log("Fail deactivate :("),this.requestStatus="failDeactivate",this.secondBtn={type:"danger",isPlain:!0},this.openMsgBox()})}openPopupForm(){document.body.classList.add("modal-open"),this.popupFormIsShown=!0}closePopupForm(){document.body.classList.remove("modal-open"),this.popupFormIsShown=!1}};Object(d["a"])([Object(m["f"])("list")],ft.prototype,"onListChanged",null),Object(d["a"])([Object(m["f"])("banner")],ft.prototype,"onBannerUpd",null),ft=Object(d["a"])([Object(m["a"])({components:{FormBanners:Qe,MessageBox:ge,PopupForm:nt,ButtonApp:_}})],ft);var vt=ft,gt=vt,bt=(s("1152"),Object(g["a"])(gt,ut,pt,!1,null,"31b4dfec",null)),_t=bt.exports,Bt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"module-banners"},[s("transition",{attrs:{mode:"out-in"}},[s("router-view",{staticClass:"module-banners__page page",on:{updateList:e.loadData}})],1),s("transition",[s("MessageBox",{directives:[{name:"show",rawName:"v-show",value:e.msgBoxIsShown,expression:"msgBoxIsShown"}],staticClass:"module-banners__msg-box modal",attrs:{content:e.msgBoxContent},on:{close:e.closeMsgBox,firstBtnClicked:e.loadData}})],1)],1)},Ct=[];const yt=m["e"].extend({methods:{...N.mapActions(["getList"])}});let It=class extends(Object(m["b"])(yt,Be)){created(){this.loadData()}loadData(){this.getList().then(()=>{console.log("List loaded!"),this.closeMsgBox()}).catch(async e=>{this.openMsgBox()})}};It=Object(d["a"])([Object(m["a"])({components:{MessageBox:ge}})],It);var Ft=It,wt=Ft,xt=(s("88c7"),Object(g["a"])(wt,Bt,Ct,!1,null,"063175de",null)),kt=xt.exports;const Tt=[{path:"list",component:Te,name:"PageBanners"},{path:"create",component:mt,name:"PageCreate"},{path:"edit",redirect:{name:"PageBanners"}},{path:"edit/:id",component:_t,name:"PageEdit"}];var St=[{path:"/banners",component:kt,name:"ModuleBanners",redirect:{name:"PageBanners"},children:Tt}],Ot={name:"banners",store:R,routes:St};a["default"].use(O.a),o.registerModule("system",T.store),n.addRoutes(T.routes),o.dispatch("system/initializeModule",Ot),new a["default"]({template:"<App/>",router:n,store:o,render:e=>e(F)}).$mount("#app")},d3b7:function(e,t,s){},dc38:function(e,t,s){},dd4d:function(e,t,s){"use strict";var a=s("5dc0"),i=s.n(a);i.a},e5ed:function(e,t,s){},f2ae:function(e,t,s){},fe6c:function(e,t,s){"use strict";var a=s("98f2"),i=s.n(a);i.a}});
//# sourceMappingURL=app.3b5b1b9f.js.map