(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2b0210e2"],{3588:function(t,s,e){"use strict";var i=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"list-restart"},[e("div",{staticClass:"list-restart__container"},[e("div",{staticClass:"list-restart__table",class:{"is-long-list":t.list&&t.list.length>2}},[e("div",{staticClass:"list-restart__row table-row"},t._l(t.fields,(function(s,i){return e("div",{staticClass:"list-restart__title table-cell",class:{"col-05":s.isSmall,"col-1":s.isMedium,"col-2":!s.isSmall&&!s.isMedium}},[0===i?e("div",{staticClass:"list-restart__checkbox checkbox",class:{"is-active":t.allAreSelected,"is-disabled":!t.list||!t.list.length},on:{click:function(s){return t.onSelectAllClick()}}},[t._m(0,!0)]):e("div",{staticClass:"list-restart__title-wrapper",class:{"is-disabled":!t.list||!t.list.length},on:{click:function(s){return t.onTitleClick(i)}}},[e("div",{staticClass:"list-restart__title-text",domProps:{innerHTML:t._s(s.title)}}),e("div",{staticClass:"list-restart__title-sort"},[e("i",{staticClass:"list-restart__title-sort-icon el-icon-caret-top",class:{"is-active":t.list&&t.list.length&&t.listSortField===t.fields[i].field&&t.isAscSorted}}),e("i",{staticClass:"list-restart__title-sort-icon el-icon-caret-bottom",class:{"is-active":t.list&&t.list.length&&t.listSortField===t.fields[i].field&&t.isDescSorted}})])])])})),0),t.list&&t.list.length?e("div",{staticClass:"list-restart__body"},t._l(t.list,(function(s,i){return e("ItemRestart",{key:i,staticClass:"list-restart__item table-row",attrs:{section:s,fields:t.fields,isActive:t.namesSelected.indexOf(s.serviceName)>=0},on:{checkboxClicked:function(e){return t.onItemCheckboxClick(s.serviceName)}}})})),1):t._e()]),e("div",{staticClass:"list-restart__btns"},[e("ButtonApp",{directives:[{name:"show",rawName:"v-show",value:t.list&&t.list.length,expression:"list && list.length"}],staticClass:"list-restart__btn",attrs:{text:"Перезапустить",isDisabled:!t.namesSelected.length},on:{clicked:t.onRestartClick}}),e("ButtonApp",{staticClass:"list-restart__btn",attrs:{text:"Обновить список",btnType:"primaryText"},on:{clicked:t.onUpdateClick}})],1)])])},c=[function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"list-restart__checkbox-icon-wrapper checkbox-icon-wrapper"},[e("i",{staticClass:"list-restart__checkbox-icon el-icon-check checkbox-icon"})])}],a=e("9ab4"),r=e("60a3"),l=e("c91f"),o=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"item-restart"},[e("div",{staticClass:"item-restart__info"},t._l(t.fields,(function(s,i){return e("div",{staticClass:"item-restart__cell table-cell",class:{"col-05":s.isSmall,"col-1":s.isMedium,"col-2":!s.isSmall&&!s.isMedium}},[0===i?e("div",{staticClass:"item-restart__checkbox checkbox",class:{"is-active":t.isActive,"is-hovered":t.checkboxIsHovered},on:{click:t.onCheckboxClick}},[t._m(0,!0)]):e("div",{staticClass:"item-restart__cell-content",domProps:{innerHTML:t._s(t.section[s.field])},on:{click:function(s){1===i&&t.onCheckboxClick()},mouseenter:function(s){return t.setCheckboxIsHovered(1===i)},mouseleave:function(s){return t.setCheckboxIsHovered(!1)}}})])})),0)])},n=[function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"item-restart__checkbox-icon-wrapper checkbox-icon-wrapper"},[e("i",{staticClass:"item-restart__checkbox-icon el-icon-check checkbox-icon"})])}],d=e("121b");let h=class extends r["e"]{constructor(){super(...arguments),this.descrIsShown=!1,this.checkboxIsHovered=!1}get cells(){return this.section&&[this.section.serviceName,this.section.replicas]}onCheckboxClick(){this.$emit("checkboxClicked")}setCheckboxIsHovered(t){this.checkboxIsHovered=t}};Object(a["a"])([Object(r["c"])()],h.prototype,"section",void 0),Object(a["a"])([Object(r["c"])()],h.prototype,"isActive",void 0),Object(a["a"])([Object(r["c"])()],h.prototype,"fields",void 0),h=Object(a["a"])([Object(r["a"])({components:{ButtonApp:d["a"]}})],h);var u=h,m=u,b=(e("84cf"),e("0c7c")),p=Object(b["a"])(m,o,n,!1,null,null,null),g=p.exports,f=e("8c15"),v=e("51a1"),S=e("521f"),_=e("dd23");const k=r["e"].extend({computed:{..._["b"].mapState(["breakpoint"])}}),x=r["e"].extend({computed:{...l["b"].mapState(["listSort"])},methods:{...l["b"].mapMutations(["updateListSort"]),...l["b"].mapActions(["editList"])}});let C=class extends(Object(r["b"])(k,x,v["a"],f["a"])){constructor(){super(...arguments),this.checkboxIsActive=!1,this.namesSelected=[]}get fields(){return[{field:null,title:"",isSmall:!0},{field:"serviceName",title:"Название"},{field:"replicas",title:this.isXs?"Кол-во реплик":"Количество реплик",isMedium:!0}]}get isXs(){return"xs"===this.breakpoint}get amountTotal(){return this.list&&this.list.length}get allAreSelected(){return this.namesSelected.length>0&&this.amountTotal===this.namesSelected.length}get allNames(){return this.list&&this.list.map(t=>t.serviceName)}get listSortField(){return this.listSort.by}get listSortDirection(){return this.listSort.direction}get isAscSorted(){return"asc"===this.listSortDirection}get isDescSorted(){return"desc"===this.listSortDirection}onIsActiveChange(t){this.resetSelect(),this.resetSort()}onSelectAllClick(){this.allAreSelected?this.namesSelected=[]:this.namesSelected=[...this.allNames]}onItemCheckboxClick(t){const s=this.namesSelected.indexOf(t),e=s>=0;e?this.namesSelected.splice(s,1):this.namesSelected.push(t)}resetSelect(){this.namesSelected=[],this.checkboxIsActive=!1}onTitleClick(t){const s=this.fields[t].field,e=s!==this.listSortField,i=e||"desc"===this.listSortDirection?"asc":"desc",c={by:s,direction:i};this.updateListSort(c)}resetSort(){const t={by:"serviceName",direction:"asc"};this.updateListSort(t)}onRestartClick(){const t=[];for(const s of this.namesSelected)t.push({serviceName:s});this.$emit("editClicked",t)}onUpdateClick(){this.$emit("updateClicked")}};Object(a["a"])([Object(r["c"])()],C.prototype,"list",void 0),Object(a["a"])([Object(r["f"])("isActive",{immediate:!0})],C.prototype,"onIsActiveChange",null),C=Object(a["a"])([Object(r["a"])({components:{ItemRestart:g,ButtonApp:d["a"],MessageBox:S["a"]}})],C);var L=C,w=L,y=(e("68fc"),Object(b["a"])(w,i,c,!1,null,"1cddd7e9",null));s["a"]=y.exports},"68fc":function(t,s,e){"use strict";var i=e("dbe7"),c=e.n(i);c.a},8073:function(t,s,e){},"84cf":function(t,s,e){"use strict";var i=e("8073"),c=e.n(i);c.a},"8c15":function(t,s,e){"use strict";var i=e("9ab4"),c=e("2b0e"),a=e("3653"),r=e("c91f"),l=e("51a1");const o=c["default"].extend({computed:{...r["b"].mapGetters(["loadingError"])}});let n=class extends(Object(a["Mixins"])(o,l["a"])){constructor(){super(...arguments),this.requestStatus="failFetchList",this.titles={success:"Готово!",fail:"Ошибка!"},this.statuses={success:["successFetchList","successEdit"],fail:["failFetchList","failEdit"]},this.btns={successFetchList:{firstBtn:"Закрыть"},successEdit:{firstBtn:"Закрыть"},failFetchList:{firstBtn:"Повторить попытку",secondBtn:"К списку разделов"},failEdit:{firstBtn:"Повторить попытку",secondBtn:"Отмена"}}}get statusType(){for(const t in this.statuses)if(this.statuses[t].indexOf(this.requestStatus)>=0)return t}get msgBoxTitle(){return this.titles[this.statusType]}get msgBoxMsg(){return this.loadingError}get msgBoxBtns(){return this.btns[this.requestStatus]}get msgBoxContent(){return{title:this.msgBoxTitle,msg:this.msgBoxMsg||this.contentDefault,...this.msgBoxBtns}}};n=Object(i["a"])([a["Mixin"]],n),s["a"]=n},c91f:function(t,s,e){"use strict";(function(t){e.d(s,"a",(function(){return h})),e.d(s,"b",(function(){return u}));var i=e("e738"),c=e("675f");const a=!0,r=t&&Object({NODE_ENV:"production",BASE_URL:"/"})&&!1;class l{constructor(){this.edit={error:null,isLoading:!1},this.hashes=["active","inactive"],this.list={data:null,error:null,isLoading:!1},this.listSort={by:"serviceName",direction:"asc"}}}class o extends c["b"]{get isLoading(){return this.state.list.isLoading||this.state.edit.isLoading}get loadingError(){return this.state.list.error||this.state.edit.error}get listSorted(){if(!this.state.list.data||!this.state.list.data.length)return;const t=[...this.state.list.data],s=this.state.listSort.by,e=this.state.listSort.direction;return t.sort((t,i)=>{let c=t[s],a=i[s];switch(s){case"serviceName":c=c.toString().toLowerCase(),a=a.toString().toLowerCase();break;case"replicas":c=Number(c),a=Number(a);break}return c>a&&"asc"===e||c<a&&"desc"===e?1:-1})}}class n extends c["d"]{updateListSort(t){this.state.listSort.by=t.by,this.state.listSort.direction=t.direction}startListLoading(){this.state.list.isLoading=!0,this.state.list.error=null}setListLoadingSuccess(t){this.state.list.data=t,this.state.list.isLoading=!1,this.state.list.error=null}setListLoadingFail(t){this.state.list.data=null,this.state.list.isLoading=!1,this.state.list.error=t}startEdit(){this.state.edit.error=null,this.state.edit.isLoading=!0}setEditSuccess(t){this.state.list.data=t,this.state.edit.error=null,this.state.edit.isLoading=!1}setEditFail(t){this.state.edit.error=t,this.state.edit.isLoading=!1}}class d extends c["a"]{async getList(){return new Promise((t,s)=>{this.commit("startListLoading"),i["a"].get("/api/v1/services-list").then(s=>{while(s&&!Array.isArray(s))s=s.data;this.commit("setListLoadingSuccess",s),r&&console.log("Success: load list"),t()}).catch(t=>{const e=t&&t.response&&t.response.data&&t.response.data.message||null;this.commit("setListLoadingFail",e),t&&t.response?s(t.response):s()})})}async editList(t){return new Promise((s,e)=>{this.commit("startEdit"),i["a"].post("/api/v1/services",t).then(async t=>{r&&console.log("Success: edit list");while(t&&!Array.isArray(t))t=t.data;this.commit("setEditSuccess",t),s()}).catch(t=>{r&&t&&t.response?console.log(t.response):console.log("error");const s=t&&t.response&&t.response.data&&t.response.data.message||null;this.commit("setEditFail",s),e()})})}}const h=new c["c"]({namespaced:a,state:l,getters:o,mutations:n,actions:d}),u=Object(c["e"])(h)}).call(this,e("4362"))},dbe7:function(t,s,e){}}]);
//# sourceMappingURL=chunk-2b0210e2.d6e2bf23.js.map