(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-37be1944"],{"2ea3":function(t,e,s){},"58da":function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"list-features"},[s("div",{staticClass:"list-features__container"},[s("div",{staticClass:"list-features__table",class:{"is-long-list":t.list.length>2}},[s("div",{staticClass:"list-features__row table-row"},t._l(t.fieldsShown,(function(e,i){return s("div",{staticClass:"list-features__title table-cell",class:{"col-05":e.isSmall,"col-1":e.isMedium,"col-2":!e.isSmall&&!e.isMedium}},[0===i?s("div",{staticClass:"list-features__checkbox checkbox",class:{"is-active":t.allAreSelected,"is-disabled":!t.list.length},on:{click:function(e){return t.onSelectAllClick()}}},[t._m(0,!0),t.isXs?s("div",{staticClass:"list-features__checkbox-text checkbox-text"},[t._v("Выбрать все")]):t._e()]):t.isXs?t._e():s("div",{staticClass:"list-features__title-wrapper",class:{"is-disabled":!t.list.length},on:{click:function(e){return t.onTitleClick(i)}}},[s("div",{staticClass:"list-features__title-text",domProps:{innerHTML:t._s(e.title)}}),i<t.fields.length-1?s("div",{staticClass:"list-features__title-sort"},[s("i",{staticClass:"list-features__title-sort-icon el-icon-caret-top",class:{"is-active":t.listSortField===t.fields[i].field&&"asc"===t.listSortDirection}}),s("i",{staticClass:"list-features__title-sort-icon el-icon-caret-bottom",class:{"is-active":t.listSortField===t.fields[i].field&&"desc"===t.listSortDirection}})]):t._e()])])})),0),t._l(t.list,(function(e,i){return s("ItemFeatures",{key:i,staticClass:"list-features__item table-row",attrs:{section:e,fields:t.fieldsShown,isActive:t.idsSelected.indexOf(e.id)>=0},on:{checkboxClicked:function(s){return t.onItemCheckboxClick(e.id)}}})}))],2),t.list.length?s("ButtonApp",{staticClass:"list-features__btn",attrs:{text:t.btn.text,btnType:t.btn.type,isDisabled:!t.idsSelected.length},on:{clicked:t.onBtnClick}}):t._e()],1)])},a=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"list-features__checkbox-icon-wrapper checkbox-icon-wrapper"},[s("i",{staticClass:"list-features__checkbox-icon el-icon-check checkbox-icon"})])}],n=s("9ab4"),c=s("60a3"),r=s("6d09"),o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"item-features"},[s("div",{staticClass:"item-features__info"},t._l(t.fields,(function(e,i){return s("div",{staticClass:"item-features__cell table-cell",class:{"col-05":e.isSmall,"col-1":e.isMedium,"col-2":!e.isSmall&&!e.isMedium}},[0===i?s("div",{staticClass:"item-features__checkbox checkbox",class:{"is-active":t.isActive},on:{click:t.onCheckboxClick}},[t._m(0,!0),t.isXs?s("div",{staticClass:"item-features__checkbox-text",domProps:{innerHTML:t._s(t.btnText)}}):t._e()]):s("div",{staticClass:"item-features__cell-content"},[t.isXs?s("div",{staticClass:"item-features__cell-content-title",domProps:{innerHTML:t._s(e.title+":&nbsp;")}}):t._e(),s("div",{staticClass:"item-features__cell-content-text",domProps:{innerHTML:t._s(t.getFieldContent(e))}})])])})),0),t.section.description?s("div",{staticClass:"item-features__descr-wrapper",class:{"is-active":t.descrIsShown},on:{click:function(e){t.descrIsShown=!t.descrIsShown}}},[s("div",{staticClass:"item-features__descr-content"},[t.isXs?s("div",{staticClass:"item-features__descr-content-title",domProps:{innerHTML:t._s("Описание:&nbsp;")}}):t._e(),s("div",{staticClass:"item-features__descr-content-text",domProps:{innerHTML:t._s(t.section.description)}})])]):t._e()])},l=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"item-features__checkbox-icon-wrapper checkbox-icon-wrapper"},[s("i",{staticClass:"item-features__checkbox-icon el-icon-check checkbox-icon"})])}],d=s("121b"),h=s("2623");const u=c["e"].extend({computed:{...h["b"].mapState(["breakpoint"])}});let f=class extends u{constructor(){super(...arguments),this.descrIsShown=!1}get isXs(){return"xs"===this.breakpoint}get status(){return this.section.active?"Активирован":"Не активирован"}get btnType(){return this.section.active?"warning":"primary"}get btnText(){return this.isActive?"Деактивировать":"Выбрать"}getFieldContent(t){return"active"===t.field?this.status:this.section[t.field]}onCheckboxClick(){this.$emit("checkboxClicked")}};Object(n["a"])([Object(c["c"])()],f.prototype,"section",void 0),Object(n["a"])([Object(c["c"])()],f.prototype,"isActive",void 0),Object(n["a"])([Object(c["c"])()],f.prototype,"fields",void 0),f=Object(n["a"])([Object(c["a"])({components:{ButtonApp:d["a"]}})],f);var m=f,p=m,b=(s("9544"),s("0c7c")),g=Object(b["a"])(p,o,l,!1,null,"6480f1f6",null),v=g.exports,_=s("7470"),S=s("51a1"),x=s("521f");const C=c["e"].extend({computed:{...h["b"].mapState(["breakpoint"])}}),k=c["e"].extend({computed:{...r["b"].mapState(["listSort","hashes"]),...r["b"].mapGetters(["listActive","listInactive"])},methods:{...r["b"].mapMutations(["updateListSort"]),...r["b"].mapActions(["editList"])}});let L=class extends(Object(c["b"])(C,k,S["a"],_["a"])){constructor(){super(...arguments),this.checkboxIsActive=!1,this.idsSelected=[]}get fields(){return[{field:null,title:"",isShown:!0,isSmall:!this.isXs},{field:"feature",isShown:!0,title:"Название"},{field:"updatedAt",isShown:!0,title:"Дата обновления"},{field:"createdAt",isShown:!0,title:"Дата создания"},{field:"active",isShown:!this.isLtMd,title:"Статус"}]}get fieldsShown(){return this.fields.filter(t=>t.isShown)}get isLtMd(){return"xs"===this.breakpoint||"sm"===this.breakpoint}get isXs(){return"xs"===this.breakpoint}get amountTotal(){return this.list&&this.list.length}get allAreSelected(){return this.idsSelected.length>0&&this.amountTotal===this.idsSelected.length}get allIds(){return this.list&&this.list.map(t=>t.id)}get listSortField(){return this.listSort.by}get listSortDirection(){return this.listSort.direction}get btn(){return this.isActive?{text:"Деактивировать",type:"warning"}:{text:"Активировать",type:"success"}}onIsActiveChange(t){this.resetSelect(),this.resetSort()}onSelectAllClick(){this.allAreSelected?this.idsSelected=[]:this.idsSelected=[...this.allIds]}onItemCheckboxClick(t){const e=this.idsSelected.indexOf(t),s=e>=0;s?this.idsSelected.splice(e,1):this.idsSelected.push(t)}resetSelect(){this.idsSelected=[],this.checkboxIsActive=!1}onTitleClick(t){if(t===this.fields.length-1&&!this.isLtMd)return;const e=this.fields[t].field,s=e!==this.listSortField,i=s||"desc"===this.listSortDirection?"asc":"desc",a={by:e,direction:i};this.updateListSort(a)}resetSort(){const t={by:"id",direction:"asc"};this.updateListSort(t)}onBtnClick(){const t=[];for(const e of this.idsSelected)t.push({id:e,active:!this.isActive});this.$emit("editClicked",t)}};Object(n["a"])([Object(c["c"])()],L.prototype,"list",void 0),Object(n["a"])([Object(c["c"])()],L.prototype,"isActive",void 0),Object(n["a"])([Object(c["f"])("isActive",{immediate:!0})],L.prototype,"onIsActiveChange",null),L=Object(n["a"])([Object(c["a"])({components:{ItemFeatures:v,ButtonApp:d["a"],MessageBox:x["a"]}})],L);var B=L,w=B,M=(s("c129"),Object(b["a"])(w,i,a,!1,null,"503f96a3",null));e["a"]=M.exports},"597f1":function(t,e,s){"use strict";s.r(e);var i=s("6d09"),a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"page-main page"},[s("div",{staticClass:"page-main__container js-voa js-voa-start"},[s("el-menu",{staticClass:"page-main__sort",attrs:{"default-active":(t.activeHashIndex+1).toString(),mode:"horizontal"},on:{select:t.handleMenuClick}},t._l(t.sortItems,(function(e,i){return s("el-menu-item",{key:i,staticClass:"page-main__sort-item",class:{"is-disabled":!t.tabs[i].list.length},attrs:{index:(i+1).toString()},domProps:{innerHTML:t._s(e)}})})),1),s("transition",{attrs:{mode:"out-in"}},[s("ListFeatures",{key:t.activeHashIndex+t.listCurrent.length,staticClass:"page-main__list",attrs:{list:t.listCurrent,isActive:0===t.activeHashIndex},on:{editClicked:t.onEditClick}})],1)],1),s("transition",[s("MessageBox",{directives:[{name:"show",rawName:"v-show",value:t.msgBoxIsShown,expression:"msgBoxIsShown"}],staticClass:"list-features__msg-box modal modal-msg",attrs:{content:t.msgBoxContent,secondBtn:t.secondBtn},on:{close:t.closeMsgBox,firstBtnClicked:t.onFirstBtnClick,secondBtnClicked:t.closeMsgBox}})],1)],1)},n=[],c=s("9ab4"),r=s("60a3"),o=s("121b"),l=s("521f"),d=s("51a1"),h=s("7470"),u=s("58da");const f=r["e"].extend({computed:{...i["b"].mapState(["listSort","hashes"]),...i["b"].mapGetters(["listActive","listInactive","isLoading"])},methods:{...i["b"].mapMutations(["updateListSort"]),...i["b"].mapActions(["editList"])}});let m=class extends(Object(r["b"])(h["a"],d["a"],f)){constructor(){super(...arguments),this.editPayload=null,this.secondBtn=null}get tabs(){try{return[{hash:this.hashes[0],list:this.listActive,sort:`Активные (${this.listActive.length})`},{hash:this.hashes[1],list:this.listInactive,sort:`Неактивные (${this.listInactive.length})`}]}catch{}}get activeHash(){return this.$route.hash}get activeHashIndex(){return this.activeHash&&this.hashes.indexOf(this.activeHash.slice(1))||0}get listCurrent(){return this.tabs&&this.tabs[this.activeHashIndex].list}get sortItems(){return this.tabs&&this.tabs.map(t=>t.sort)}handleMenuClick(t){this.$router.push({path:this.$route.path,hash:`#${this.hashes[t-1]}`}).catch(t=>{})}onEditClick(t){t&&(this.editPayload=t),this.requestStatus="beforeEdit",this.secondBtn={type:"danger",isPlain:!0},this.msgBoxOtherMsgs["beforeEdit"]=this.beforeEditMsg[this.activeHashIndex],this.openMsgBox()}editConfirm(){this.editList(this.editPayload).then(()=>{if(!this.listCurrent.length){const t=0===this.activeHashIndex?2:1;this.handleMenuClick(t)}this.editPayload=null}).catch(()=>{this.requestStatus="failEdit",this.openMsgBox()})}onFirstBtnClick(){switch(this.closeMsgBox(),this.requestStatus){case"beforeEdit":case"failEdit":this.editConfirm();break}}};m=Object(c["a"])([Object(r["a"])({components:{MessageBox:l["a"],ButtonApp:o["a"],ListFeatures:u["a"]},mixins:[h["a"]]})],m);var p=m,b=p,g=(s("f142"),s("0c7c")),v=Object(g["a"])(b,a,n,!1,null,"03dc7c38",null),_=v.exports;const S=[{path:"/",component:_,name:"PageFeatures"},{path:"*",redirect:{name:"PageFeatures"}}];var x=[{path:"/features",component:()=>s.e("features").then(s.bind(null,"8b41")),name:"ModuleFeatures",redirect:{name:"PageFeatures"},children:S,meta:{title:"Вкл/откл разделов",isDynamicModule:!0}}];e["default"]={name:"features",store:i["a"],routes:x}},"5dc1":function(t,e,s){},"6d09":function(t,e,s){"use strict";(function(t){s.d(e,"a",(function(){return u})),s.d(e,"b",(function(){return f}));var i=s("e738"),a=s("675f");const n=!0,c=t&&Object({NODE_ENV:"production",BASE_URL:"/"})&&!1;class r{constructor(){this.edit={error:null,isLoading:!1},this.hashes=["active","inactive"],this.list={data:null,error:null,isLoading:!1},this.listSort={by:"id",direction:"asc"}}}class o extends a["b"]{get isLoading(){return this.state.list.isLoading||this.state.edit.isLoading}get loadingError(){return this.state.list.error||this.state.edit.error}get listSorted(){if(!this.state.list.data||!this.state.list.data.length)return;const t=[...this.state.list.data],e=this.state.listSort.by,s=this.state.listSort.direction;return t.sort((t,i)=>{let a=t[e],n=i[e];switch(e){case"feature":a=a.toString().toLowerCase(),n=n.toString().toLowerCase();break;case"updatedAt":case"createdAt":a=h(a.toString()),n=h(n.toString());break}return a>n&&"asc"===s||a<n&&"desc"===s?1:-1})}get listActive(){return this.getters.listSorted&&this.getters.listSorted.filter(t=>t.active)}get listInactive(){return this.getters.listSorted&&this.getters.listSorted.filter(t=>!t.active)}}class l extends a["d"]{updateListSort(t){this.state.listSort.by=t.by,this.state.listSort.direction=t.direction}startListLoading(){this.state.list.isLoading=!0,this.state.list.error=null}setListLoadingSuccess(t){this.state.list.data=t,this.state.list.isLoading=!1,this.state.list.error=null}setListLoadingFail(t){this.state.list.data=null,this.state.list.isLoading=!1,this.state.list.error=t}startEdit(){this.state.edit.error=null,this.state.edit.isLoading=!0}setEditSuccess(){this.state.edit.error=null,this.state.edit.isLoading=!1}setEditFail(t){this.state.edit.error=t,this.state.edit.isLoading=!1}}class d extends a["a"]{async getList(){return new Promise((t,e)=>{this.commit("startListLoading"),i["a"].get("/api/v1/features-list").then(e=>{while(!Array.isArray(e))e=e.data;this.commit("setListLoadingSuccess",e),c&&console.log("Success: load list"),t()}).catch(t=>{const s=t&&t.response&&t.response.data&&t.response.data.message||null;this.commit("setListLoadingFail",s),t&&t.response?e(t.response):e()})})}async editList(t){return new Promise((e,s)=>{this.commit("startEdit"),i["a"].post("/api/v1/features",t).then(async()=>{c&&console.log("Success: edit list"),await this.dispatch("getList",null),this.commit("setEditSuccess"),e()}).catch(t=>{c&&t&&t.response?console.log(t.response):console.log("error");const e=t&&t.response&&t.response.data&&t.response.data.message||null;this.commit("setEditFail",e),s()})})}}const h=t=>{let e=t.split(/-| |:/);const s=new Date;s.setDate(Number(e[0])),s.setMonth(Number(e[1])-1),s.setFullYear(Number(e[2])),s.setHours(Number(e[3]),Number(e[4]),0,0);const i=s.getTime();return i},u=new a["c"]({namespaced:n,state:r,getters:o,mutations:l,actions:d}),f=Object(a["e"])(u)}).call(this,s("4362"))},7470:function(t,e,s){"use strict";var i=s("9ab4"),a=s("2b0e"),n=s("3653"),c=s("6d09"),r=s("51a1");const o=a["default"].extend({computed:{...c["b"].mapGetters(["loadingError"])}});let l=class extends(Object(n["Mixins"])(o,r["a"])){constructor(){super(...arguments),this.requestStatus="failFetchList",this.titles={success:"Готово!",fail:"Ошибка!",other:"Вы уверены?"},this.statuses={success:["successFetchList","successEdit"],fail:["failFetchList","failEdit"],other:["beforeEdit"]},this.btns={successFetchList:{firstBtn:"Закрыть"},successEdit:{firstBtn:"Закрыть"},failFetchList:{firstBtn:"Повторить попытку",secondBtn:"К списку разделов"},failEdit:{firstBtn:"Повторить попытку",secondBtn:"Отмена"},beforeEdit:{firstBtn:"Подтвердить",secondBtn:"Отмена"}},this.msgBoxOtherMsgs={beforeEdit:""},this.beforeEditMsg={0:"Указанные разделы перестанут отображаться в приложении.<br>Хотите продолжить?",1:"Указанные разделы станут доступны в приложении.<br>Хотите продолжить?"}}get statusType(){for(const t in this.statuses)if(this.statuses[t].indexOf(this.requestStatus)>=0)return t}get msgBoxTitle(){return this.titles[this.statusType]}get msgBoxMsg(){return"other"===this.statusType?this.msgBoxOtherMsgs[this.requestStatus]:this.loadingError}get msgBoxBtns(){return this.btns[this.requestStatus]}get msgBoxContent(){return{title:this.msgBoxTitle,msg:this.msgBoxMsg||this.contentDefault,...this.msgBoxBtns}}};l=Object(i["a"])([n["Mixin"]],l),e["a"]=l},9544:function(t,e,s){"use strict";var i=s("2ea3"),a=s.n(i);a.a},"9ec6":function(t,e,s){},c129:function(t,e,s){"use strict";var i=s("9ec6"),a=s.n(i);a.a},f142:function(t,e,s){"use strict";var i=s("5dc1"),a=s.n(i);a.a}}]);
//# sourceMappingURL=chunk-37be1944.97168dd5.js.map