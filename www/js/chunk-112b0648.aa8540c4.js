(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-112b0648"],{"13b5":function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"title-table"},[s("div",{staticClass:"title-table__wrapper",class:{"is-disabled":!t.isSortable},on:{click:t.onTitleClick}},[s("div",{staticClass:"title-table__text",domProps:{innerHTML:t._s(t.title)}}),t.isSortable?s("div",{staticClass:"title-table__sort"},[s("i",{staticClass:"title-table__sort-icon el-icon-caret-top",class:{"is-active":t.isAscSorted}}),s("i",{staticClass:"title-table__sort-icon el-icon-caret-bottom",class:{"is-active":t.isDescSorted}})]):t._e()])])},a=[],c=s("9ab4"),l=s("60a3");let r=class extends l["e"]{onTitleClick(){this.$emit("titleClicked")}};Object(c["a"])([Object(l["c"])()],r.prototype,"title",void 0),Object(c["a"])([Object(l["c"])()],r.prototype,"isSortable",void 0),Object(c["a"])([Object(l["c"])()],r.prototype,"isAscSorted",void 0),Object(c["a"])([Object(l["c"])()],r.prototype,"isDescSorted",void 0),r=Object(c["a"])([Object(l["a"])({})],r);var o=r,n=o,d=(s("e8b9"),s("0c7c")),h=Object(d["a"])(n,i,a,!1,null,"360beddc",null);e["a"]=h.exports},"1c7d":function(t,e,s){},"2aca":function(t,e,s){},"312b":function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"checkbox-table"},[s("div",{staticClass:"checkbox-table__checkbox checkbox",class:{"is-active":t.isActive,"is-disabled":t.isDisabled},on:{click:function(e){return t.onSelectAllClick()}}},[t._m(0),t.text?s("div",{staticClass:"checkbox-table__text checkbox-text",domProps:{innerHTML:t._s(t.text)}}):t._e()])])},a=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"checkbox-table__icon-wrapper checkbox-icon-wrapper"},[s("i",{staticClass:"checkbox-table__icon el-icon-check checkbox-icon"})])}],c=s("9ab4"),l=s("60a3");let r=class extends l["e"]{onSelectAllClick(){this.$emit("selectAllClicked")}};Object(c["a"])([Object(l["c"])()],r.prototype,"isActive",void 0),Object(c["a"])([Object(l["c"])()],r.prototype,"isDisabled",void 0),Object(c["a"])([Object(l["c"])()],r.prototype,"text",void 0),r=Object(c["a"])([Object(l["a"])({})],r);var o=r,n=o,d=(s("9b0f"),s("0c7c")),h=Object(d["a"])(n,i,a,!1,null,"75baf10b",null);e["a"]=h.exports},3588:function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"list-restart"},[s("div",{staticClass:"list-restart__container"},[s("div",{staticClass:"list-restart__table",class:{"is-long-list":t.list&&t.list.length>2}},[s("div",{staticClass:"list-restart__row table-row table-head"},t._l(t.fields,(function(e,i){return s("div",{staticClass:"list-restart__title table-cell",class:{"col-05":e.isSmall,"col-1":e.isMedium,"col-2":!e.isSmall&&!e.isMedium,"is-centered":e.isCentered}},[0===i?s("CheckboxTable",{attrs:{isActive:t.allAreSelected,isDisabled:!t.list||!t.list.length},on:{selectAllClicked:function(e){return t.onSelectAllClick()}}}):s("TitleTable",{attrs:{title:e.title,isSortable:!(!t.list||!t.list.length),isAscSorted:t.list&&t.list.length&&t.listSortField===t.fields[i].field&&t.isAscSorted,isDescSorted:t.list&&t.list.length&&t.listSortField===t.fields[i].field&&t.isDescSorted},on:{titleClicked:function(e){return t.onTitleClick(i)}}})],1)})),0),t.list&&t.list.length?s("div",{staticClass:"list-restart__body"},t._l(t.list,(function(e,i){return s("ItemRestart",{key:i,staticClass:"list-restart__item table-row",attrs:{section:e,fields:t.fields,isActive:t.namesSelected.indexOf(e.serviceName)>=0},on:{checkboxClicked:function(s){return t.onItemCheckboxClick(e.serviceName)}}})})),1):t._e()]),s("div",{staticClass:"list-restart__btns"},[s("ButtonApp",{directives:[{name:"show",rawName:"v-show",value:t.list&&t.list.length,expression:"list && list.length"}],staticClass:"list-restart__btn",attrs:{text:"Перезапустить",isDisabled:!t.namesSelected.length},on:{clicked:t.onRestartClick}}),s("ButtonApp",{staticClass:"list-restart__btn",attrs:{text:"Обновить список",btnType:"primaryText"},on:{clicked:t.onUpdateClick}})],1)])])},a=[],c=s("9ab4"),l=s("60a3"),r=s("c91f"),o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"item-restart"},[s("div",{staticClass:"item-restart__info"},t._l(t.fields,(function(e,i){return s("div",{staticClass:"item-restart__cell table-cell",class:{"col-05":e.isSmall,"col-1":e.isMedium,"col-2":!e.isSmall&&!e.isMedium,"is-centered":e.isCentered}},[0===i?s("div",{staticClass:"item-restart__checkbox checkbox",class:{"is-active":t.isActive,"is-hovered":t.checkboxIsHovered},on:{click:t.onCheckboxClick}},[t._m(0,!0)]):s("div",{staticClass:"item-restart__cell-content",domProps:{innerHTML:t._s(t.section[e.field])},on:{click:function(e){1===i&&t.onCheckboxClick()},mouseenter:function(e){return t.setCheckboxIsHovered(1===i)},mouseleave:function(e){return t.setCheckboxIsHovered(!1)}}})])})),0)])},n=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"item-restart__checkbox-icon-wrapper checkbox-icon-wrapper"},[s("i",{staticClass:"item-restart__checkbox-icon el-icon-check checkbox-icon"})])}],d=s("121b");let h=class extends l["e"]{constructor(){super(...arguments),this.descrIsShown=!1,this.checkboxIsHovered=!1}get cells(){return this.section&&[this.section.serviceName,this.section.replicas]}onCheckboxClick(){this.$emit("checkboxClicked")}setCheckboxIsHovered(t){this.checkboxIsHovered=t}};Object(c["a"])([Object(l["c"])()],h.prototype,"section",void 0),Object(c["a"])([Object(l["c"])()],h.prototype,"isActive",void 0),Object(c["a"])([Object(l["c"])()],h.prototype,"fields",void 0),h=Object(c["a"])([Object(l["a"])({components:{ButtonApp:d["a"]}})],h);var u=h,b=u,m=(s("84cf"),s("0c7c")),p=Object(m["a"])(b,o,n,!1,null,null,null),f=p.exports,v=s("8c15"),g=s("51a1"),C=s("521f"),S=s("2623"),k=s("312b"),x=s("13b5");const _=l["e"].extend({computed:{...S["b"].mapState(["breakpoint"])}}),O=l["e"].extend({computed:{...r["b"].mapState(["listSort"])},methods:{...r["b"].mapMutations(["updateListSort"]),...r["b"].mapActions(["editList"])}});let L=class extends(Object(l["b"])(_,O,g["a"],v["a"])){constructor(){super(...arguments),this.namesSelected=[]}get fields(){return[{field:null,title:"",isSmall:!0},{field:"serviceName",title:"Название"},{field:"replicas",title:this.isXs?"Кол-во реплик":"Количество реплик",isMedium:!0,isCentered:!0}]}get isXs(){return"xs"===this.breakpoint}get amountTotal(){return this.list&&this.list.length}get allAreSelected(){return this.namesSelected.length>0&&this.amountTotal===this.namesSelected.length}get allNames(){return this.list&&this.list.map(t=>t.serviceName)}get listSortField(){return this.listSort.by}get listSortDirection(){return this.listSort.direction}get isAscSorted(){return"asc"===this.listSortDirection}get isDescSorted(){return"desc"===this.listSortDirection}onIsActiveChange(t){this.resetSelect(),this.resetSort()}onSelectAllClick(){this.allAreSelected?this.namesSelected=[]:this.namesSelected=[...this.allNames]}onItemCheckboxClick(t){const e=this.namesSelected.indexOf(t),s=e>=0;s?this.namesSelected.splice(e,1):this.namesSelected.push(t)}resetSelect(){this.namesSelected=[]}onTitleClick(t){const e=this.fields[t].field,s=e!==this.listSortField,i=s||"desc"===this.listSortDirection?"asc":"desc",a={by:e,direction:i};this.updateListSort(a)}resetSort(){const t={by:"serviceName",direction:"asc"};this.updateListSort(t)}onRestartClick(){const t=[];for(const e of this.namesSelected)t.push({serviceName:e});this.$emit("editClicked",t)}onUpdateClick(){this.$emit("updateClicked")}};Object(c["a"])([Object(l["c"])()],L.prototype,"list",void 0),Object(c["a"])([Object(l["f"])("isActive",{immediate:!0})],L.prototype,"onIsActiveChange",null),L=Object(c["a"])([Object(l["a"])({components:{ItemRestart:f,ButtonApp:d["a"],MessageBox:C["a"],CheckboxTable:k["a"],TitleTable:x["a"]}})],L);var j=L,y=j,A=(s("eba5"),Object(m["a"])(y,i,a,!1,null,"7a080fbf",null));e["a"]=A.exports},"7b18":function(t,e,s){"use strict";s.r(e);var i=s("c91f"),a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"page-main page"},[s("div",{staticClass:"page-main__container"},[s("ListRestart",{key:t.listSorted+t.editPayload,staticClass:"page-main__list",attrs:{list:t.listSorted},on:{editClicked:t.onEditClick,updateClicked:t.onUpdateClick}})],1),s("transition",[s("MessageBox",{directives:[{name:"show",rawName:"v-show",value:t.msgBoxIsShown&&t.editFailed,expression:"msgBoxIsShown && editFailed"}],staticClass:"list-features__msg-box modal modal-msg",attrs:{content:t.msgBoxContent},on:{close:t.closeMsgBox,firstBtnClicked:t.onFirstBtnClick,secondBtnClicked:t.closeMsgBox}})],1)],1)},c=[],l=s("9ab4"),r=s("60a3"),o=s("121b"),n=s("521f"),d=s("51a1"),h=s("8c15"),u=s("3588");const b=r["e"].extend({computed:{...i["b"].mapState(["list"]),...i["b"].mapGetters(["isLoading","listSorted"])},methods:{...i["b"].mapActions(["editList"])}});let m=class extends(Object(r["b"])(h["a"],d["a"],b)){constructor(){super(...arguments),this.editPayload=null}get editFailed(){return"failEdit"===this.requestStatus}onEditClick(t){t&&(this.editPayload=t),this.editList(this.editPayload).then(()=>{this.editPayload=null}).catch(()=>{this.requestStatus="failEdit",this.openMsgBox()})}onUpdateClick(){this.$emit("updateList")}onFirstBtnClick(){switch(this.closeMsgBox(),this.requestStatus){case"failEdit":this.onEditClick();break}}};m=Object(l["a"])([Object(r["a"])({components:{MessageBox:n["a"],ButtonApp:o["a"],ListRestart:u["a"]},mixins:[h["a"]]})],m);var p=m,f=p,v=(s("7cf7"),s("0c7c")),g=Object(v["a"])(f,a,c,!1,null,"83c7d872",null),C=g.exports;const S=[{path:"/",component:C,name:"PageRestart"},{path:"*",redirect:{name:"PageRestart"}}];var k=[{path:"/restart",component:()=>s.e("restart").then(s.bind(null,"2d6d")),name:"ModuleRestart",redirect:{name:"PageRestart"},children:S,meta:{title:"Рестарт сервисов",isDynamicModule:!0}}];e["default"]={name:"restart",store:i["a"],routes:k}},"7cf7":function(t,e,s){"use strict";var i=s("1c7d"),a=s.n(i);a.a},"7ee0":function(t,e,s){},8073:function(t,e,s){},"84cf":function(t,e,s){"use strict";var i=s("8073"),a=s.n(i);a.a},"8c15":function(t,e,s){"use strict";var i=s("9ab4"),a=s("2b0e"),c=s("3653"),l=s("c91f"),r=s("51a1");const o=a["default"].extend({computed:{...l["b"].mapGetters(["loadingError"])}});let n=class extends(Object(c["Mixins"])(o,r["a"])){constructor(){super(...arguments),this.requestStatus="failFetchList",this.titles={success:"Готово!",fail:"Ошибка!"},this.statuses={success:["successFetchList","successEdit"],fail:["failFetchList","failEdit"]},this.btns={successFetchList:{firstBtn:"Закрыть"},successEdit:{firstBtn:"Закрыть"},failFetchList:{firstBtn:"Повторить попытку",secondBtn:"К списку разделов"},failEdit:{firstBtn:"Повторить попытку",secondBtn:"Отмена"}}}get statusType(){for(const t in this.statuses)if(this.statuses[t].indexOf(this.requestStatus)>=0)return t}get msgBoxTitle(){return this.titles[this.statusType]}get msgBoxMsg(){return this.loadingError}get msgBoxBtns(){return this.btns[this.requestStatus]}get msgBoxContent(){return{title:this.msgBoxTitle,msg:this.msgBoxMsg||this.contentDefault,...this.msgBoxBtns}}};n=Object(i["a"])([c["Mixin"]],n),e["a"]=n},"9b0f":function(t,e,s){"use strict";var i=s("7ee0"),a=s.n(i);a.a},afef:function(t,e,s){},c91f:function(t,e,s){"use strict";(function(t){s.d(e,"a",(function(){return h})),s.d(e,"b",(function(){return u}));var i=s("e738"),a=s("675f");const c=!0,l=t&&Object({NODE_ENV:"production",BASE_URL:"/"})&&!1;class r{constructor(){this.edit={error:null,isLoading:!1},this.hashes=["active","inactive"],this.list={data:null,error:null,isLoading:!1},this.listSort={by:"serviceName",direction:"asc"}}}class o extends a["b"]{get isLoading(){return this.state.list.isLoading||this.state.edit.isLoading}get loadingError(){return this.state.list.error||this.state.edit.error}get listSorted(){if(!this.state.list.data||!this.state.list.data.length)return;const t=[...this.state.list.data],e=this.state.listSort.by,s=this.state.listSort.direction;return t.sort((t,i)=>{let a=t[e],c=i[e];switch(e){case"serviceName":a=a.toString().trim().toLowerCase(),c=c.toString().trim().toLowerCase();break;case"replicas":a=Number(a),c=Number(c);break}return a>c&&"asc"===s||a<c&&"desc"===s?1:-1})}}class n extends a["d"]{updateListSort(t){this.state.listSort.by=t.by,this.state.listSort.direction=t.direction}startListLoading(){this.state.list.isLoading=!0,this.state.list.error=null}setListLoadingSuccess(t){this.state.list.data=t,this.state.list.isLoading=!1,this.state.list.error=null}setListLoadingFail(t){this.state.list.data=null,this.state.list.isLoading=!1,this.state.list.error=t}startEdit(){this.state.edit.error=null,this.state.edit.isLoading=!0}setEditSuccess(t){this.state.list.data=t,this.state.edit.error=null,this.state.edit.isLoading=!1}setEditFail(t){this.state.edit.error=t,this.state.edit.isLoading=!1}}class d extends a["a"]{async getList(){return new Promise((t,e)=>{this.commit("startListLoading"),i["a"].get("/api/v1/services-list").then(e=>{while(e&&!Array.isArray(e))e=e.data;this.commit("setListLoadingSuccess",e),l&&console.log("Success: load restart services list"),t()}).catch(t=>{const s=t&&t.response&&t.response.data&&t.response.data.message||null;this.commit("setListLoadingFail",s),t&&t.response?e(t.response):e()})})}async editList(t){return new Promise((e,s)=>{this.commit("startEdit"),i["a"].post("/api/v1/services",t).then(async t=>{l&&console.log("Success: edit list");while(t&&!Array.isArray(t))t=t.data;this.commit("setEditSuccess",t),e()}).catch(t=>{l&&t&&t.response?console.log(t.response):console.log("error");const e=t&&t.response&&t.response.data&&t.response.data.message||null;this.commit("setEditFail",e),s()})})}}const h=new a["c"]({namespaced:c,state:r,getters:o,mutations:n,actions:d}),u=Object(a["e"])(h)}).call(this,s("4362"))},e8b9:function(t,e,s){"use strict";var i=s("afef"),a=s.n(i);a.a},eba5:function(t,e,s){"use strict";var i=s("2aca"),a=s.n(i);a.a}}]);
//# sourceMappingURL=chunk-112b0648.aa8540c4.js.map